{
    "version": "https://jsonfeed.org/version/1",
    "title": "自强不息 厚德载物 • All posts by \"3. 处理工具\" category",
    "description": "分享各种内容，方便自己与他人查阅，欢迎评论",
    "home_page_url": "https://synrst.de",
    "items": [
        {
            "id": "https://synrst.de/%E8%99%9A%E6%8B%9F%E7%8E%AF%E5%A2%83/3.%20%E5%A4%84%E7%90%86%E5%B7%A5%E5%85%B7/IDE/",
            "url": "https://synrst.de/%E8%99%9A%E6%8B%9F%E7%8E%AF%E5%A2%83/3.%20%E5%A4%84%E7%90%86%E5%B7%A5%E5%85%B7/IDE/",
            "title": "IDE",
            "date_published": "1970-01-01T00:00:00.000Z",
            "content_html": "<h1 id=\"1-Clion\"><a href=\"#1-Clion\" class=\"headerlink\" title=\"1 Clion\"></a>1 Clion</h1><h2 id=\"1-1-linux\"><a href=\"#1-1-linux\" class=\"headerlink\" title=\"1.1 linux\"></a>1.1 linux</h2><p>有两种 linux 远程方式，包含编译的<a href=\"https://www.jetbrains.com/help/clion/remote-projects-support.html\"> Full remote mode</a> 和仅调试 <a href=\"https://www.jetbrains.com/help/clion/remote-debug-via-gdb-gdbserver.html\">Remote debug</a> 模式</p>\n<ul>\n<li>Full 模式涉及编译因此要写 CMakeLists.txt</li>\n<li>Full 模式要在 Deployment 选择 mounted folder，否则每次都要用 SFTP 上传源码，要配置 Folder 和 Mappings<ul>\n<li>cmake 设置选项 <code>-v -- -j 3</code> 打印具体的编译命令</li>\n</ul>\n</li>\n<li>Debug 模式只需要添加一个配置，指定执行文件的目录，设置 Path mappings。用 Remote GDB Server 或 Remote Debug 都可以</li>\n</ul>\n<h3 id=\"1-1-1-相关问题\"><a href=\"#1-1-1-相关问题\" class=\"headerlink\" title=\"1.1.1 相关问题\"></a>1.1.1 相关问题</h3><ul>\n<li>clangd 内存占用过多，限制成 500MB，<a href=\"https://stackoverflow.com/questions/61346400/clion-clangd-how-to-limit-memory-usage\">Clion clangd, how to limit memory usage</a></li>\n<li><a href=\"https://www.jetbrains.com/help/clion/performance-tuning-tips.html#increase-heap\">堆内存占用过多和其它性能问题</a>，Help | Change Memory Settings 改成 1000MB</li>\n<li>cmake 输出引号乱码，参考<a href=\"https://youtrack.jetbrains.com/issue/CPP-11641\">这个</a>将 Default encoding 改为 UTF-8，<code>Settings / Preferences | Editor | General | Console_ settings</code></li>\n<li>要出现点击函数后卡在 “Resolving References” 上，把 Use navigation via clangd 关了</li>\n<li>ubuntu 20.04 remote debug 开启 sudo 运行后无法 debug（18.04 没这个问题，gdb 版本？），程序退出 <a href=\"https://youtrack.jetbrains.com/issue/CPP-23810\">CPP-23810</a> 和 <a href=\"https://youtrack.jetbrains.com/issue/CPP-25441\">CPP-25441</a>。暂时通过开始 ssh 的 root 登录绕过</li>\n<li><a href=\"https://youtrack.jetbrains.com/issue/CPP-14177\">pretty printers 设置失败</a>  中 Andrew Brownsword 的回答<ul>\n<li>把 Windows clion 下的 <code>bin\\gdb\\renderers</code>  拷到 linux</li>\n<li>打开 <code>#com.jetbrains.cidr.execution.debugger</code> 调试，找到 idea.log 中的 WARN <code>python import sys ... sys.path.insert(0, ...</code> 开始的这一行，改为 renders 路径，如 <code>sys.path.insert(0, &quot;/home/zack/code/install/renderers&quot;)</code>。把整个这一行加到 linux 的 gdbinit 文件中，路径在 <code>~/.gdbinit</code> 或系统配置 <code>/etc/gdb/gdbinit</code></li>\n</ul>\n</li>\n<li>设置断点后 printf 没有输出，<a href=\"https://youtrack.jetbrains.com/issue/CPP-10733\">解决方法</a> 是在程序开始处添加 <code>setbuf(stdout, 0);</code></li>\n</ul>\n<h1 id=\"2-Keil\"><a href=\"#2-Keil\" class=\"headerlink\" title=\"2 Keil\"></a>2 Keil</h1><h1 id=\"3-QT\"><a href=\"#3-QT\" class=\"headerlink\" title=\"3 QT\"></a>3 QT</h1><p><a href=\"https://blog.csdn.net/yanchenyu365/article/details/110949727\">参考</a> 从清华镜像下载在线安装工具，QT 账号登录，自定义安装，按参考中截图选择</p>\n<h1 id=\"4-VSCode\"><a href=\"#4-VSCode\" class=\"headerlink\" title=\"4 VSCode\"></a>4 VSCode</h1><ul>\n<li>解压缩 zip 后，创建 data 文件夹，开启 <a href=\"https://code.visualstudio.com/docs/editor/portable\">portable mode</a></li>\n<li>liveserver 提升端口占用，因为防火墙没放开</li>\n<li>下载 gtags，将 bin 路径添加到系统环境变量，要重启</li>\n<li>要是工程大为了快速查引用，则关 C&#x2F;C++ 扩展，开启 C&#x2F;C++ GNU Global 扩展，<a href=\"https://www.jianshu.com/p/df3a8ca739b0\">扩展选择参考</a></li>\n</ul>\n<h2 id=\"4-1-快捷键\"><a href=\"#4-1-快捷键\" class=\"headerlink\" title=\"4.1 快捷键\"></a>4.1 快捷键</h2><table>\n<thead>\n<tr>\n<th></th>\n<th></th>\n</tr>\n</thead>\n<tbody><tr>\n<td>ctrl+k, ctrl+s</td>\n<td>查看、设置快捷键</td>\n</tr>\n<tr>\n<td>ctrl + o</td>\n<td>当前符号</td>\n</tr>\n<tr>\n<td>ctrl + shift + o</td>\n<td>模糊全局符号搜索</td>\n</tr>\n<tr>\n<td>alt + t</td>\n<td>全局符号搜索</td>\n</tr>\n<tr>\n<td>alt + f</td>\n<td>文件</td>\n</tr>\n<tr>\n<td>F1 &#x2F; ctrl + shift + p</td>\n<td>配置命令</td>\n</tr>\n<tr>\n<td>ctrl + shift + f8 &#x2F; shift + f8</td>\n<td>高亮</td>\n</tr>\n</tbody></table>\n<h2 id=\"4-2-自定义编译\"><a href=\"#4-2-自定义编译\" class=\"headerlink\" title=\"4.2 自定义编译\"></a>4.2 自定义编译</h2><ul>\n<li><p>比如 cool 的编译和运行添加两个 task，一个属于 build group，一个是 test。示例 json 如下</p>\n  <figure class=\"highlight json\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"punctuation\">&#123;</span></span><br><span class=\"line\">    <span class=\"comment\">// See https://go.microsoft.com/fwlink/?LinkId=733558</span></span><br><span class=\"line\">    <span class=\"comment\">// for the documentation about the tasks.json format</span></span><br><span class=\"line\">    <span class=\"attr\">&quot;version&quot;</span><span class=\"punctuation\">:</span> <span class=\"string\">&quot;2.0.0&quot;</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">    <span class=\"attr\">&quot;tasks&quot;</span><span class=\"punctuation\">:</span> <span class=\"punctuation\">[</span></span><br><span class=\"line\">        <span class=\"punctuation\">&#123;</span></span><br><span class=\"line\">            <span class=\"attr\">&quot;label&quot;</span><span class=\"punctuation\">:</span> <span class=\"string\">&quot;编译当前目录&quot;</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">            <span class=\"attr\">&quot;type&quot;</span><span class=\"punctuation\">:</span> <span class=\"string\">&quot;shell&quot;</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">            <span class=\"attr\">&quot;command&quot;</span><span class=\"punctuation\">:</span> <span class=\"string\">&quot;coolc&quot;</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">            <span class=\"attr\">&quot;args&quot;</span><span class=\"punctuation\">:</span> <span class=\"punctuation\">[</span></span><br><span class=\"line\">                <span class=\"string\">&quot;$&#123;fileDirname&#125;/*.cl&quot;</span><span class=\"punctuation\">,</span> <span class=\"string\">&quot;-o&quot;</span><span class=\"punctuation\">,</span> <span class=\"string\">&quot;$&#123;fileDirname&#125;/$&#123;fileBasenameNoExtension&#125;.s&quot;</span></span><br><span class=\"line\">            <span class=\"punctuation\">]</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">            <span class=\"attr\">&quot;problemMatcher&quot;</span><span class=\"punctuation\">:</span> <span class=\"punctuation\">[</span><span class=\"punctuation\">]</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">            <span class=\"attr\">&quot;group&quot;</span><span class=\"punctuation\">:</span> <span class=\"punctuation\">&#123;</span></span><br><span class=\"line\">                <span class=\"attr\">&quot;kind&quot;</span><span class=\"punctuation\">:</span> <span class=\"string\">&quot;build&quot;</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">                <span class=\"attr\">&quot;isDefault&quot;</span><span class=\"punctuation\">:</span> <span class=\"literal\"><span class=\"keyword\">true</span></span></span><br><span class=\"line\">            <span class=\"punctuation\">&#125;</span></span><br><span class=\"line\">        <span class=\"punctuation\">&#125;</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">        <span class=\"punctuation\">&#123;</span></span><br><span class=\"line\">            <span class=\"attr\">&quot;label&quot;</span><span class=\"punctuation\">:</span> <span class=\"string\">&quot;spim 运行&quot;</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">            <span class=\"attr\">&quot;type&quot;</span><span class=\"punctuation\">:</span> <span class=\"string\">&quot;shell&quot;</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">            <span class=\"attr\">&quot;command&quot;</span><span class=\"punctuation\">:</span> <span class=\"string\">&quot;spim&quot;</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">            <span class=\"attr\">&quot;args&quot;</span><span class=\"punctuation\">:</span> <span class=\"punctuation\">[</span></span><br><span class=\"line\">                <span class=\"string\">&quot;$&#123;fileDirname&#125;/$&#123;fileBasenameNoExtension&#125;.s&quot;</span></span><br><span class=\"line\">            <span class=\"punctuation\">]</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">            <span class=\"attr\">&quot;problemMatcher&quot;</span><span class=\"punctuation\">:</span> <span class=\"punctuation\">[</span><span class=\"punctuation\">]</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">            <span class=\"attr\">&quot;group&quot;</span><span class=\"punctuation\">:</span> <span class=\"punctuation\">&#123;</span></span><br><span class=\"line\">                <span class=\"attr\">&quot;kind&quot;</span><span class=\"punctuation\">:</span> <span class=\"string\">&quot;test&quot;</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">                <span class=\"attr\">&quot;isDefault&quot;</span><span class=\"punctuation\">:</span> <span class=\"literal\"><span class=\"keyword\">true</span></span></span><br><span class=\"line\">            <span class=\"punctuation\">&#125;</span></span><br><span class=\"line\">        <span class=\"punctuation\">&#125;</span></span><br><span class=\"line\">    <span class=\"punctuation\">]</span></span><br><span class=\"line\"><span class=\"punctuation\">&#125;</span></span><br></pre></td></tr></table></figure></li>\n</ul>\n<h2 id=\"4-3-远程开发\"><a href=\"#4-3-远程开发\" class=\"headerlink\" title=\"4.3 远程开发\"></a>4.3 远程开发</h2><ul>\n<li>参考<a href=\"https://code.visualstudio.com/docs/remote/ssh\">官方文档</a> 设置要连接的设备，连上后要设置远程设备的代理的话（如安装插件），在设置的 remote 中 ，设置好后重连<ul>\n<li>其它如编译和调试都和<a href=\"https://code.visualstudio.com/docs/cpp/config-linux\">本地</a>一样，由 3 个文件管理，看<a href=\"https://code.visualstudio.com/docs/cpp/introvideos-cpp\">介绍视频</a>更快上手<ul>\n<li><code>tasks.json</code> (compiler build settings)</li>\n<li><code>launch.json</code> (debugger settings)</li>\n<li><code>c_cpp_properties.json</code> (compiler path and IntelliSense settings)</li>\n</ul>\n</li>\n</ul>\n</li>\n<li>免密码验证，生成 rsa key，<code>C:\\Users\\XXX\\.ssh\\config</code> 文件增加一行 <code>IdentityFile C:\\Users\\XXX\\.ssh\\id_rsa</code> 并把私钥拷贝到这里，公钥放在远程设备的 <code>~/.ssh/authorized_keys</code> 中（没有新建、有则追加）<ul>\n<li>参考<a href=\"https://code.visualstudio.com/docs/remote/troubleshooting#_configuring-key-based-authentication\">官方文档</a> 和 <a href=\"https://stackoverflow.com/questions/66113731/how-to-save-ssh-password-to-vscode\">stackoverflow</a></li>\n</ul>\n</li>\n<li>对于改本地 mount 的驱动器，远程执行编译命令的情况，可用 <a href=\"https://marketplace.visualstudio.com/items?itemName=Kelvin.vscode-sshfs\">SSH FS</a> 的 <code>ssh-shell</code> task<ul>\n<li>host 指定用的配置文件，workingDirectory 指定目录，command 远程执行的命令，注意只打印 stderr 没有 stdout，可 <a href=\"https://stackoverflow.com/questions/30542501/on-a-linux-system-how-would-i-redirect-stdout-to-stderr\">redirect stdout to stderr</a></li>\n<li><code>&quot;command&quot;: &quot;bash -c \\&quot;/usr/class/cs143/cool/bin/coolc ${fileBasenameNoExtension}.cl -o ${fileBasenameNoExtension}.s &amp;&amp; printf &#39;\\nCompile Success!\\n&#39; \\&quot; &quot;,</code></li>\n</ul>\n</li>\n</ul>\n<h1 id=\"5-VIM\"><a href=\"#5-VIM\" class=\"headerlink\" title=\"5 VIM\"></a>5 VIM</h1><h2 id=\"5-1-安装\"><a href=\"#5-1-安装\" class=\"headerlink\" title=\"5.1 安装\"></a>5.1 安装</h2><ul>\n<li><p>源码编译方法可以重新查找，目前参考 <a href=\"https://github.com/Valloric/YouCompleteMe/wiki/Building-Vim-from-source\">Building-Vim-from-source</a>，要额外开启 clipboard 和 xterm_clipboard 特性编译时加 –with-x ， <a href=\"https://stackoverflow.com/questions/11416069/compile-vim-with-clipboard-and-xterm\">参考</a></p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">./configure --with-features=huge \\</span><br><span class=\"line\">            --enable-multibyte \\</span><br><span class=\"line\">\t    --enable-rubyinterp=<span class=\"built_in\">yes</span> \\</span><br><span class=\"line\">\t    --enable-pythoninterp=<span class=\"built_in\">yes</span> \\</span><br><span class=\"line\">\t    --enable-python3interp=<span class=\"built_in\">yes</span> \\</span><br><span class=\"line\">\t    --with-python3-config-dir=/usr/lib/python3.7/config \\</span><br><span class=\"line\">\t    --enable-perlinterp=<span class=\"built_in\">yes</span> \\</span><br><span class=\"line\">\t    --enable-luainterp=<span class=\"built_in\">yes</span> \\</span><br><span class=\"line\">            --enable-gui=gtk2 \\</span><br><span class=\"line\">            --enable-cscope \\</span><br><span class=\"line\">\t\t\t--with-x \\</span><br><span class=\"line\">\t   --prefix=/usr/local</span><br><span class=\"line\">make VIMRUNTIMEDIR=/usr/local/share/vim/vim81 -j8</span><br><span class=\"line\"><span class=\"comment\"># 使用 checkinstall 安装</span></span><br><span class=\"line\">sudo checkinstall</span><br><span class=\"line\"><span class=\"comment\"># 替换默认 vi</span></span><br><span class=\"line\">update-alternatives --display vi</span><br><span class=\"line\">sudo update-alternatives --install /usr/bin/vi vi /usr/local/bin/vim 51 --slave /usr/share/man/man1/vi.1.gz vi.1.gz /usr/local/share/man/man1/vim.1.gz</span><br><span class=\"line\"><span class=\"comment\"># 卸载</span></span><br><span class=\"line\">dpkg -r vim</span><br></pre></td></tr></table></figure>\n</li>\n<li><p>也可 apt 安装 vim-gome，安装前确定一下版本是 vim8</p>\n</li>\n</ul>\n<h2 id=\"5-2-TAG-数据库\"><a href=\"#5-2-TAG-数据库\" class=\"headerlink\" title=\"5.2 TAG 数据库\"></a>5.2 TAG 数据库</h2><h3 id=\"5-2-1-内核-tag-生成\"><a href=\"#5-2-1-内核-tag-生成\" class=\"headerlink\" title=\"5.2.1 内核 tag 生成\"></a>5.2.1 内核 tag 生成</h3><p>tag 生成参考 <a href=\"https://stackoverflow.com/questions/33676829/vim-configuration-for-linux-kernel-development\">内核代码生成tag</a>、<a href=\"http://cscope.sourceforge.net/large_projects.html\">cscope 大型项目用法</a></p>\n<p>参考第一篇使用 <code>make O=. ARCH=arm SUBARCH=exynos COMPILED_SOURCE=1 cscope tags</code> 生成</p>\n<p>后续考虑能否生成 gtags 数据库</p>\n<h3 id=\"5-2-2-universal-ctags\"><a href=\"#5-2-2-universal-ctags\" class=\"headerlink\" title=\"5.2.2 universal-ctags\"></a>5.2.2 universal-ctags</h3><p>ubuntu 自带的 ctag 版本太老，源码安装参考 <a href=\"https://www.cnblogs.com/zjutzz/p/9393397.html\">Ubuntu16.04安装配置和使用 universal-ctags</a></p>\n<h3 id=\"5-2-3-GTags\"><a href=\"#5-2-3-GTags\" class=\"headerlink\" title=\"5.2.3 GTags\"></a>5.2.3 GTags</h3><p>下载源码编译安装 <a href=\"https://zhuanlan.zhihu.com/p/36279445\">Vim 8 中 C&#x2F;C++ 符号索引：GTags 篇</a>、<a href=\"https://zhuanlan.zhihu.com/p/64842373\">LeaderF 支持 GTags</a></p>\n<p>对于需要跳过的目录 <a href=\"https://stackoverflow.com/questions/42315741/how-gtags-exclude-some-specific-subdirectories\">修改配置文件</a> ，参考 man gtags，如 <code>/src_comm/lib/:</code>，然后在 vimrc 中设置 <code>let g:Lf_Gtagsconf = &#39;/home/xxx/.vim/gtags.conf&#39;</code></p>\n<h2 id=\"5-3-配置\"><a href=\"#5-3-配置\" class=\"headerlink\" title=\"5.3 配置\"></a>5.3 配置</h2><table>\n<thead>\n<tr>\n<th>按键</th>\n<th>内容</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>F2</td>\n<td>paste toggle</td>\n</tr>\n<tr>\n<td>F3</td>\n<td>set list toggle</td>\n</tr>\n<tr>\n<td>F4</td>\n<td>highlight toggle</td>\n</tr>\n<tr>\n<td>tab</td>\n<td>insert 切换到 normal</td>\n</tr>\n<tr>\n<td>leader + leader</td>\n<td>noraml 切换窗口</td>\n</tr>\n<tr>\n<td>c - k &#x2F; c - j</td>\n<td>上下滚动，set scroll&#x3D;5</td>\n</tr>\n<tr>\n<td>leader + q</td>\n<td>关闭窗口</td>\n</tr>\n<tr>\n<td>leader + w</td>\n<td>删除 buffer</td>\n</tr>\n<tr>\n<td>leader + e</td>\n<td>[except]删除自己以外的 buffer</td>\n</tr>\n<tr>\n<td>leader + r</td>\n<td>查找存在定义的引用，不存在定义输命令查</td>\n</tr>\n<tr>\n<td>leader + t</td>\n<td>[tag] 全局 tag</td>\n</tr>\n<tr>\n<td>leader + o</td>\n<td>打开查找结果窗口</td>\n</tr>\n<tr>\n<td>leader + p</td>\n<td>上一条结果</td>\n</tr>\n<tr>\n<td>leader + a</td>\n<td>[alternative buffer] buffer 切换</td>\n</tr>\n<tr>\n<td>leader + s</td>\n<td>[search]查询字符串</td>\n</tr>\n<tr>\n<td>leader + d</td>\n<td>查询定义</td>\n</tr>\n<tr>\n<td>leader + f</td>\n<td>[file] 搜索文件</td>\n</tr>\n<tr>\n<td>leader + g</td>\n<td>[tag] 本地 tag</td>\n</tr>\n<tr>\n<td>leader + j</td>\n<td>[j 与文件 f 键位对应] 最近打开文件</td>\n</tr>\n<tr>\n<td>leader + l</td>\n<td>[list] 显示 tag 列表</td>\n</tr>\n<tr>\n<td>leader + b</td>\n<td>[buffer] 搜索buffer</td>\n</tr>\n<tr>\n<td>leader + n</td>\n<td>下一条结果</td>\n</tr>\n<tr>\n<td>leader + m</td>\n<td>[max]只留下当前窗口</td>\n</tr>\n<tr>\n<td>leader + 1-9</td>\n<td>buffer 切换</td>\n</tr>\n</tbody></table>\n<table>\n<thead>\n<tr>\n<th>插件名称</th>\n<th>介绍</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>LeaderF</td>\n<td>文件、符号、buffer 模糊查找，需要 python 支持<br />执行 install.sh 提高速度</td>\n</tr>\n<tr>\n<td>tagbar</td>\n<td>使用 ctag 动态解析 buffer 的 tag，形成 tag 列表，配合 airline 在状态栏显示</td>\n</tr>\n<tr>\n<td>vim-airline</td>\n<td>状态栏美化，还带很多插件，tabline 用于 buffer 和 tab 管理。需要的字体在 vi.assets 文件夹里，配置 securecrt 即可</td>\n</tr>\n<tr>\n<td>vim-airline-themes</td>\n<td>airline 主题</td>\n</tr>\n<tr>\n<td>vim-dirvish</td>\n<td>模仿 netrw 不占用侧边栏的文件管理方式，使用当前窗口打开文件</td>\n</tr>\n<tr>\n<td>asyncrun</td>\n<td>异步执行 shell 命令，输出到 quickfix</td>\n</tr>\n<tr>\n<td>BufOnly</td>\n<td>关闭除当前外其它 buffer</td>\n</tr>\n</tbody></table>\n<p>插件以 help 文档及 github 页面为主，其次看别人的典型用法，英文优先。不排除某些插件的功能就是不完善的可能，因此为了将 vi 用的更好，我认为学习编写插件是必须的。vi 的配置与插件以精简和全面熟悉为原则，只选择少数成熟的插件</p>\n<h2 id=\"5-4-配置备份\"><a href=\"#5-4-配置备份\" class=\"headerlink\" title=\"5.4 配置备份\"></a>5.4 配置备份</h2><p>optionally-loaded 的插件需要把 start 文件夹替换为 opt，相关 <a href=\"https://shapeshed.com/vim-packages/\">vim-packages</a>、<a href=\"https://gist.github.com/manasthakur/d4dc9a610884c60d944a4dd97f0b3560\">Using git-submodules to version-control Vim plugins</a></p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 配置放到 .vim</span></span><br><span class=\"line\"><span class=\"built_in\">cd</span></span><br><span class=\"line\"><span class=\"built_in\">mv</span> .vimrc .vim/vimrc</span><br><span class=\"line\"><span class=\"built_in\">ln</span> -s .vim/vimrc .vimrc</span><br><span class=\"line\"><span class=\"built_in\">cd</span> .vim</span><br><span class=\"line\">git init</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 安装插件</span></span><br><span class=\"line\">git submodule init</span><br><span class=\"line\">git submodule add https://github.com/vim-airline/vim-airline.git pack/plugins/start/vim-airline</span><br><span class=\"line\"><span class=\"comment\"># 安装完后可能需要生成 help tag</span></span><br><span class=\"line\">:helptags ALL</span><br><span class=\"line\"><span class=\"comment\"># 备份到远端</span></span><br><span class=\"line\">git commit -m <span class=\"string\">&quot;Initial commit.&quot;</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 还原</span></span><br><span class=\"line\">git <span class=\"built_in\">clone</span> --recurse-submodules -j8 git://github.com/foo/bar.git</span><br><span class=\"line\"><span class=\"comment\"># 或只还原、更新插件</span></span><br><span class=\"line\">git submodule update --init --recursive --remote</span><br><span class=\"line\"><span class=\"comment\"># git checkout 时也更新 submodule 的内容</span></span><br><span class=\"line\">git submodule update --recursive</span><br><span class=\"line\">git checkout master --recurse-submodules</span><br><span class=\"line\">git commit</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 删除插件</span></span><br><span class=\"line\">git submodule deinit pack/plugins/start/vim-airline</span><br><span class=\"line\">git <span class=\"built_in\">rm</span> pack/plugins/start/vim-airline</span><br><span class=\"line\"><span class=\"built_in\">rm</span> -Rf pack/plugins/start/vim-airline</span><br><span class=\"line\">git commit</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"5-5-修改别人的插件\"><a href=\"#5-5-修改别人的插件\" class=\"headerlink\" title=\"5.5 修改别人的插件\"></a>5.5 修改别人的插件</h2><ol>\n<li><p>在 submodule 中新建 branch，并添加自己的 remote。目前使用的是和 vim 配置备份相同的 repo，分支名称以插件名称命名</p>\n</li>\n<li><p>基于这个 branch 修改，并 push -u</p>\n</li>\n<li><p>更新插件的 url 和 branch 为自己的，这样 git push 就可以将插件修改推送到自己的 repo 来备份</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 参考 https://stackoverflow.com/questions/913701/how-to-change-the-remote-repository-for-a-git-submodule</span></span><br><span class=\"line\"><span class=\"comment\"># 列出目前的</span></span><br><span class=\"line\">git config --file=.gitmodules -l</span><br><span class=\"line\"><span class=\"comment\"># 改 .gitmodules</span></span><br><span class=\"line\">git config --file=.gitmodules submodule.pack/plugins/start/BufOnly.vim.url git@github.com:Jianfeng-Du/vim-config.git</span><br><span class=\"line\">git config --file=.gitmodules submodule.pack/plugins/start/BufOnly.vim.branch BufOnly</span><br><span class=\"line\"><span class=\"comment\"># 更新 .git 和 submodule 文件夹中的 config</span></span><br><span class=\"line\">git submodule <span class=\"built_in\">sync</span></span><br></pre></td></tr></table></figure>\n</li>\n<li><p>要更新远端的修改，就要切换到原来的 branch pull，然后再把这个 branch merge 到自己修改的 branch 中，然后 push 到自己的 repo。更新了插件需要分别在 submodule 和 主目录提交也可以。<code>git push --recurse-submodules=check</code>，<code>git push --recurse-submodules=on-demand</code></p>\n</li>\n</ol>\n<h2 id=\"5-6-操作技巧\"><a href=\"#5-6-操作技巧\" class=\"headerlink\" title=\"5.6 操作技巧\"></a>5.6 操作技巧</h2><ul>\n<li><code>*</code> 查找指针所在单词的下一个位置，<code>#</code> 查找上一个，配合高亮开关使用</li>\n<li>移除行尾空格 <code>:%s/\\s\\+$//e</code>，<a href=\"https://vim.fandom.com/wiki/Search_and_replace\">Search and replace</a></li>\n<li>wbef 在行中定位，也有大写版本，0^$</li>\n<li>m + 小写字母 buffer 中 mark，大写字母全局 mark。’ 或 &#96; 加字母跳转到 mark，’’ 恢复到跳转前（只能 buffer 内用）</li>\n<li>% 转到匹配的条目</li>\n<li>滚动首字母 up、down、forward、back、Home、Middle、Last <a href=\"https://medium.com/usevim/vim-101-quick-movement-c12889e759e0\">Quick Movement</a>，zz 将光标内容放入总间，zt、zb</li>\n<li>c-r 是重做，redo</li>\n<li>c-d、c-t 调整缩进，插入真正的 tab  <code>&lt;c-v&gt; &lt;tab&gt;</code> ，<a href=\"https://vi.stackexchange.com/questions/704/insert-tabs-in-insert-mode-when-expandtab-is-set\">Insert tabs in INSERT mode when expandtab is set</a></li>\n<li>获取某项设置的值加 ?，如 set list?</li>\n<li>重新载入配置比如 vimrc，:so %，<a href=\"https://superuser.com/questions/132029/how-do-you-reload-your-vimrc-file-without-restarting-vim\">How do you reload your .vimrc file without restarting vim?</a></li>\n<li>操作字符，yl、r、x</li>\n<li>在 change list 中跳转，<code>&#39;.</code> <code>g;</code> <code>g,</code>，<a href=\"https://stackoverflow.com/questions/1722681/how-to-go-back-to-lines-edited-before-the-last-one-in-vim\">How to go back to lines edited before the last one in Vim?</a></li>\n<li>输入模式 c-p c-n word completion</li>\n<li>5&gt;&gt;.. 缩进，&#x3D; 自动调整 <a href=\"https://vim.fandom.com/wiki/Shifting_blocks_visually\">Shifting blocks visually</a></li>\n<li><a href=\"https://www.google.com/search?hl=en&as_q=vim+site:springest.io&newwindow=1\">https://www.google.com/search?hl=en&amp;as_q=vim+site%3Aspringest.io&amp;newwindow=1</a></li>\n</ul>\n<h2 id=\"5-7-下一步\"><a href=\"#5-7-下一步\" class=\"headerlink\" title=\"5.7 下一步\"></a>5.7 下一步</h2><ul>\n<li>vi 操作有个闯关游戏可以不断练习，vi 的优势自然是使用键盘，所以打算练习盲打</li>\n<li>学习编写插件，进一步精简插件</li>\n</ul>\n<h3 id=\"5-7-1-相关内容\"><a href=\"#5-7-1-相关内容\" class=\"headerlink\" title=\"5.7.1 相关内容\"></a>5.7.1 相关内容</h3><ul>\n<li>以后可以考虑 动态语法检查、git 修改提示、自动补全，<a href=\"https://www.zhihu.com/question/47691414/answer/373700711\">如何在 Linux 下利用 Vim 搭建 C&#x2F;C++ 开发环境?</a></li>\n<li>说明学习编写 vimscript 的重要，给出推荐资料 <a href=\"https://www.zhihu.com/question/20833248\">如何优雅地使用 Vim？</a></li>\n<li><a href=\"https://www.jianshu.com/p/e62bbbf31e85\">airline 需要用的中文字体</a></li>\n<li>目前可以使用官方插件了，<a href=\"https://vi.stackexchange.com/questions/16888/using-global-command-on-quickfix-entries\">修改quickfix</a></li>\n</ul>\n<h3 id=\"5-7-2-系统学习\"><a href=\"#5-7-2-系统学习\" class=\"headerlink\" title=\"5.7.2 系统学习\"></a>5.7.2 系统学习</h3><ul>\n<li><a href=\"https://harttle.land/\">介绍 git 与 vi - 中文</a></li>\n<li><a href=\"http://vimcasts.org/\">介绍 vi 操作视频</a></li>\n<li><a href=\"http://vim.wikia.com/wiki/Vim_Tips_Wiki\">vim tips</a></li>\n</ul>\n<p><a href=\"https://github.com/2-3-5-7/2-3-5-7.github.io/tree/main/虚拟环境/3. 处理工具/IDE\"><i class=\"fa-solid fa-download fa-2xl\" style=\"color: gray;\"></i></a></p>\n",
            "tags": []
        },
        {
            "id": "https://synrst.de/%E8%99%9A%E6%8B%9F%E7%8E%AF%E5%A2%83/3.%20%E5%A4%84%E7%90%86%E5%B7%A5%E5%85%B7/linux%E8%BD%AF%E4%BB%B6%E7%BC%96%E8%AF%91%E3%80%81%E5%AE%89%E8%A3%85%E3%80%81%E8%BF%90%E8%A1%8C/",
            "url": "https://synrst.de/%E8%99%9A%E6%8B%9F%E7%8E%AF%E5%A2%83/3.%20%E5%A4%84%E7%90%86%E5%B7%A5%E5%85%B7/linux%E8%BD%AF%E4%BB%B6%E7%BC%96%E8%AF%91%E3%80%81%E5%AE%89%E8%A3%85%E3%80%81%E8%BF%90%E8%A1%8C/",
            "title": "linux软件编译、安装、运行",
            "date_published": "1970-01-01T00:00:00.000Z",
            "content_html": "<h1 id=\"1-编译\"><a href=\"#1-编译\" class=\"headerlink\" title=\"1 编译\"></a>1 编译</h1><p>参考 <a href=\"https://askubuntu.com/questions/466651/how-do-i-use-the-latest-gcc-on-ubuntu\">https://askubuntu.com/questions/466651/how-do-i-use-the-latest-gcc-on-ubuntu</a></p>\n<h2 id=\"1-1-静态链接-libc\"><a href=\"#1-1-静态链接-libc\" class=\"headerlink\" title=\"1.1 静态链接 libc\"></a>1.1 静态链接 libc</h2><ul>\n<li>不推荐链接 glibc （如 <a href=\"https://stackoverflow.com/questions/2725255/create-statically-linked-binary-that-uses-getaddrinfo\">getaddrinfo</a>）。用 alpine 的 musl，pull <a href=\"https://hub.docker.com/_/alpine/\">官方 docker</a> 后安装 <a href=\"https://radupopescu.net/tech/static_linking_for_cpp/#compiling\">这些</a></li>\n<li>启动 docker 映射本地的源码，在 docker 中编译<ul>\n<li>用 -pthread 而非 -lpthread，<a href=\"https://stackoverflow.com/questions/23250863/difference-between-pthread-and-lpthread-while-compiling\">区别</a></li>\n<li>gcc 链接时使用 -static。一个复杂的 <a href=\"https://stackoverflow.com/questions/10763394/how-to-build-a-c-program-using-a-custom-version-of-glibc-and-static-linking\">例子</a></li>\n</ul>\n</li>\n<li>编译后 strip 程序</li>\n</ul>\n<h2 id=\"1-2-交叉编译\"><a href=\"#1-2-交叉编译\" class=\"headerlink\" title=\"1.2 交叉编译\"></a>1.2 交叉编译</h2><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># gcc 包含文件查询路径</span></span><br><span class=\"line\"><span class=\"built_in\">echo</span> | gcc -E -Wp,-v -</span><br><span class=\"line\"><span class=\"comment\"># 加 -Wl,--verbose 来看使用库的路径信息</span></span><br><span class=\"line\">gcc -o <span class=\"built_in\">test</span> main.o -ltest -L. -Wl,--verbose</span><br><span class=\"line\"><span class=\"comment\"># 查看 so 名字</span></span><br><span class=\"line\">readelf -a -W elffile | grep SONAME</span><br><span class=\"line\"><span class=\"comment\"># 查看可执行文件需要的 so</span></span><br><span class=\"line\">readelf -a -W elffile | grep NEEDED</span><br><span class=\"line\"><span class=\"comment\"># 查看符号 https://stackoverflow.com/questions/34732/how-do-i-list-the-symbols-in-a-so-file</span></span><br><span class=\"line\">objdump -t Lib1.o</span><br><span class=\"line\">nm -g yourLib.so</span><br><span class=\"line\"><span class=\"comment\"># 查看 man 文档</span></span><br><span class=\"line\">man -l tcpdump.1</span><br></pre></td></tr></table></figure>\n\n<p>对于 rpath 和 sysroot 可参考</p>\n<p><a href=\"http://www.fabriziodini.eu/posts/cross_compile_tutorial/\">Building and cross-compile tutorial</a></p>\n<p><a href=\"https://www.cnblogs.com/xieyajie/p/4699724.html\">Ubuntu实现树莓派交叉编译（也解释了 build host target）</a></p>\n<p><a href=\"https://blog.csdn.net/LEON1741/article/details/81537529\">交叉编译器的命名规则</a></p>\n<p><a href=\"https://stackoverflow.com/questions/51839902/using-a-shared-library-in-another-shared-library\">using-a-shared-library-in-another-shared-library</a></p>\n<p>编译时指定 soname <code>-soname=name</code>，也可用工具<a href=\"https://stackoverflow.com/questions/18467163/is-there-any-way-to-change-the-soname-of-a-binary-directly\">修改 so 名字</a></p>\n<p><a href=\"https://developer.huawei.com/consumer/cn/forum/topicview?mod=viewthread&tid=41600287\">理清gcc、libc、libstdc++的关系</a></p>\n<p><a href=\"https://developer.huawei.com/consumer/cn/forum/topicview?fid=26&tid=41600244\">一张图看懂C&#x2F;C++核心库</a></p>\n<h2 id=\"1-3-Windows-编译\"><a href=\"#1-3-Windows-编译\" class=\"headerlink\" title=\"1.3 Windows 编译\"></a>1.3 Windows 编译</h2><p><a href=\"https://cygwin.com/install.html\">安装 cygwin</a>，保留安装程序用于后续添加&#x2F;删除 package</p>\n<p><a href=\"https://superuser.com/questions/996332/what-is-the-difference-between-the-different-gcc-on-cygwin-and-which-one-to-ins\">gcc 编译器安装包的选择</a></p>\n<ul>\n<li>cygwin32-gcc-g++ is a compiler for 32 bit cygwin</li>\n<li>gcc-g++ is the basic 64 bit compiler (you probably must install this one).</li>\n<li>mingw-gcc-g++ is a 32 bit compiler for native 32 bit Windows</li>\n<li>mingw64-x86_64-gcc-g++ is a 64 bit compiler for native 64 bit Windows</li>\n<li>mingw64-i686-gcc-g++ is a 64 bit compiler for native 32 bit Windows</li>\n</ul>\n<p><a href=\"https://stackoverflow.com/questions/27344540/what-do-the-c-compilers-on-cygwin-generate\">gcc 编译器名称区别</a>，注意  &#x2F;usr&#x2F;bin 下的 gcc 使用的是硬连接，可以用 <code>ls -il /usr/bin/*gcc*</code> 确认</p>\n<ol>\n<li><code>gcc</code> is just a hard link to <code>x86_64-pc-cygwin-gcc</code></li>\n<li><code>x86_64-pc-cygwin-gcc</code> and <code>i686-pc-cygwin-gcc</code> are as you have said the Cygwin compilers, that is to say the compilers that create programs that rely on <code>cygwin1.dll</code></li>\n<li><code>x86_64-w64-mingw32-gcc</code> and <code>i686-w64-mingw32-gcc</code> are compilers provided by the <a href=\"http://mingw-w64.org/\">Mingw-w64 project</a></li>\n<li><code>i686-pc-mingw32-gcc</code> is a compiler provided by the <a href=\"http://mingw.org/\">MinGW project</a></li>\n</ol>\n<p>编译和运行</p>\n<ul>\n<li>依赖 cygwin 的程序要将 <code>/bin/cygwin1.dll</code> (c:\\cygwin\\bin\\cygwin1.dll) 添加到 windows 的 path 中，使用 ming 编译的不需要</li>\n<li>切换到 d 盘，<code>cd /cygdrive/d</code></li>\n</ul>\n<p>必要时使用编程解决，下载 <a href=\"https://sourceforge.net/projects/mingw-w64/files/\">mingw-w64</a> 的 x86_64-win32-seh，<a href=\"https://www.eclipse.org/4diac/documentation/html/installation/minGW.html\">安装参考</a></p>\n<h1 id=\"2-安装\"><a href=\"#2-安装\" class=\"headerlink\" title=\"2 安装\"></a>2 安装</h1><ul>\n<li>安装前备份虚拟机快照</li>\n<li>修改的配置进行备份，方便出错恢复</li>\n<li>官方安装指南是重点，安装时的提示与安装后的帮助也注意。其它的方法 .&#x2F;configure –help，README and INSTALL 文档</li>\n<li>版本不求新，stable 和 LTS 优先</li>\n<li>版本太老可以考虑万能的源码安装，方便可以选择 apt 安装。ppa 也可以考虑</li>\n</ul>\n<h2 id=\"2-1-apt-安装\"><a href=\"#2-1-apt-安装\" class=\"headerlink\" title=\"2.1 apt 安装\"></a>2.1 apt 安装</h2><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 通过查找名称和描述找到包，i 表示已安装，也可用 apt</span></span><br><span class=\"line\">apt search &lt;package&gt;</span><br><span class=\"line\">aptitude search &lt;package&gt;</span><br><span class=\"line\"><span class=\"comment\"># 查看包详细信息</span></span><br><span class=\"line\">apt show &lt;package&gt;</span><br><span class=\"line\">apt-cache show &lt;package&gt;</span><br><span class=\"line\"><span class=\"comment\"># 查询已安装和要升级某个软件的版本</span></span><br><span class=\"line\">apt policy fdisk</span><br><span class=\"line\">aptitude versions fdisk</span><br><span class=\"line\"><span class=\"comment\"># 模拟安装和模拟升级</span></span><br><span class=\"line\">apt-get -s install &lt;package&gt;</span><br><span class=\"line\">aptitude -V -s install &lt;package&gt;</span><br><span class=\"line\">apt-get -V -s upgrade</span><br><span class=\"line\"><span class=\"comment\"># 指定版本安装</span></span><br><span class=\"line\">sudo apt-get install &lt;package&gt;=&lt;version&gt;</span><br><span class=\"line\"><span class=\"comment\"># 已安装的软件列表</span></span><br><span class=\"line\">apt list --installed</span><br><span class=\"line\"><span class=\"comment\"># 已安装包的文件列表</span></span><br><span class=\"line\">dpkg -L &lt;package&gt;</span><br><span class=\"line\"><span class=\"comment\"># 下载包的源码</span></span><br><span class=\"line\">apt-get <span class=\"built_in\">source</span> &lt;package&gt;</span><br><span class=\"line\">apt-get <span class=\"built_in\">source</span> &lt;package&gt;=&lt;version&gt;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 为什么安装和为什么没装，从下往上看</span></span><br><span class=\"line\">aptitude why &lt;package&gt;</span><br><span class=\"line\">aptitude why-not &lt;package&gt;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"2-2-源码安装\"><a href=\"#2-2-源码安装\" class=\"headerlink\" title=\"2.2 源码安装\"></a>2.2 源码安装</h2><p>源码安装典型步骤</p>\n<blockquote>\n<p>The autogen.sh script generates the configure script (from configure.ac, using autoconf) and any files it needs (like creating Makefile.in from Makefile.am using automake). This requires autotools to be installed on your system, and it must be run when checking out the project from source control (if configure isn’t checked in). People who download source tarballs can usually skip this step, because output of this step is included in source tarballs.</p>\n<p>The configure script generates Makefile and other files needed to build. Typically Makefile.in is used as a template to generate Makefile (and config.h.in to generate config.h). This process happens using only standard tools installed on your system, like sed and awk, and doesn’t require autotools to be installed.</p>\n<p>The make command builds the software.</p>\n<p>The make install command installs it.</p>\n</blockquote>\n<h1 id=\"3-运行\"><a href=\"#3-运行\" class=\"headerlink\" title=\"3 运行\"></a>3 运行</h1><ul>\n<li><a href=\"https://askubuntu.com/questions/454253/how-to-run-32-bit-app-in-ubuntu-64-bit\">在 64 位 linux 运行 32 位程序</a></li>\n<li>参考 <a href=\"https://stackoverflow.com/questions/6270440/simple-logical-operators-in-bash\">这个</a> 将编译器课程中的 spim 脚本 <code>[${1:0:1} != &quot;-&quot;]</code> 改成两个方括号外加参数判断 <code>[[ $# -ne 0 &amp;&amp; &quot;${1:0:1}&quot; != &quot;-&quot; ]]</code></li>\n</ul>\n",
            "tags": []
        },
        {
            "id": "https://synrst.de/%E8%99%9A%E6%8B%9F%E7%8E%AF%E5%A2%83/3.%20%E5%A4%84%E7%90%86%E5%B7%A5%E5%85%B7/%E4%BB%A3%E7%A0%81%E5%88%86%E6%9E%90/",
            "url": "https://synrst.de/%E8%99%9A%E6%8B%9F%E7%8E%AF%E5%A2%83/3.%20%E5%A4%84%E7%90%86%E5%B7%A5%E5%85%B7/%E4%BB%A3%E7%A0%81%E5%88%86%E6%9E%90/",
            "title": "代码分析",
            "date_published": "1970-01-01T00:00:00.000Z",
            "content_html": "<h1 id=\"1-Call-graph\"><a href=\"#1-Call-graph\" class=\"headerlink\" title=\"1 Call graph\"></a>1 Call graph</h1><p><a href=\"https://blog.csdn.net/solstice/article/details/488865\">分析函数调用关系图 (call graph) 的几种方法</a></p>\n<h2 id=\"1-1-静态\"><a href=\"#1-1-静态\" class=\"headerlink\" title=\"1.1 静态\"></a>1.1 静态</h2><h3 id=\"1-1-1-Doxygen-Graphviz-Htmlhelp-windows\"><a href=\"#1-1-1-Doxygen-Graphviz-Htmlhelp-windows\" class=\"headerlink\" title=\"1.1.1 Doxygen + Graphviz + Htmlhelp (windows)\"></a>1.1.1 Doxygen + Graphviz + Htmlhelp (windows)</h3><ul>\n<li><p>使用 Doxygen + Graphviz + Htmlhelp，<a href=\"https://blog.csdn.net/u010740725/article/details/51387810\">Doxygen 配置</a>，再加上下面两图，不要选生成 Chinese，否则 chm 文件乱码</p>\n<p>  <img src=\"/%E8%99%9A%E6%8B%9F%E7%8E%AF%E5%A2%83/3.%20%E5%A4%84%E7%90%86%E5%B7%A5%E5%85%B7/%E4%BB%A3%E7%A0%81%E5%88%86%E6%9E%90/../%E4%BB%A3%E7%A0%81%E5%88%86%E6%9E%90/1.PNG\"></p>\n<p>  <img src=\"/%E8%99%9A%E6%8B%9F%E7%8E%AF%E5%A2%83/3.%20%E5%A4%84%E7%90%86%E5%B7%A5%E5%85%B7/%E4%BB%A3%E7%A0%81%E5%88%86%E6%9E%90/../%E4%BB%A3%E7%A0%81%E5%88%86%E6%9E%90/2.PNG\"></p>\n</li>\n<li><p>生成前将不用的第三方库代码移走</p>\n</li>\n<li><p><code>Doxygen error: failed to run html help compiler on index.hhp</code> 报错似乎不影响</p>\n</li>\n</ul>\n<h3 id=\"1-1-2-SciTools-Understand-windows\"><a href=\"#1-1-2-SciTools-Understand-windows\" class=\"headerlink\" title=\"1.1.2 SciTools Understand (windows)\"></a>1.1.2 SciTools Understand (windows)</h3><p><a href=\"https://support.scitools.com/t/creating-accurate-c-c-projects/39\">C&#x2F;C++ 项目参考</a>， <a href=\"https://support.scitools.com/t/buildspy-for-gcc-g-users/40\">Buildspy - For gcc&#x2F;g++ Users</a></p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 使用 cygwin 的 /x86_64-w64-mingw32-gcc.exe 编译 openssl</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># buildspy.exe、g++wrapper.exe、gccwrapper.exe 移入上一层目录(\\SciTools\\bin\\pc-win64)，否则找不到 qt 等 dll</span></span><br><span class=\"line\"><span class=\"comment\"># 正常配置好项目</span></span><br><span class=\"line\">./Configure --prefix=/cygdrive/d/Desktop/openssl2/openssl-openssl-3.0.0-alpha9/install mingw64</span><br><span class=\"line\">make clean</span><br><span class=\"line\"><span class=\"comment\"># 为了找到 buildspy 和 wrapper</span></span><br><span class=\"line\"><span class=\"built_in\">export</span> PATH=<span class=\"string\">&quot;/cygdrive/d/MySoftware/SciTools/bin/pc-win64:<span class=\"variable\">$PATH</span>&quot;</span></span><br><span class=\"line\"><span class=\"comment\"># 替换编译器</span></span><br><span class=\"line\"><span class=\"built_in\">export</span> CC=gccwrapper</span><br><span class=\"line\">buildspy.exe -db openssl.udb -verbose -cmd make</span><br><span class=\"line\"><span class=\"comment\"># 打开 openssl.udb</span></span><br><span class=\"line\">project -&gt; analyze all files</span><br><span class=\"line\">project -&gt; improve project accuracy -&gt; missing includes 添加 include 文件 C:\\cygwin64\\usr\\x86_64-w64-mingw32\\sys-root\\mingw\\include</span><br></pre></td></tr></table></figure>\n\n<ul>\n<li>对于 openssl，一处非常奇怪的宏定义字符串导致编译不过问题，原 Makefile 是 -DOPENSSLDIR&#x3D;”&quot;$(OPENSSLDIR)&quot;，使用 gcc 编译没问题，但使用 gccwrapper 就要改成 -DOPENSSLDIR&#x3D;’ “$(OPENSSLDIR)”‘，注意单引号与双引号间的空格不能省略。在同一行有 3 处都要改。宏定义问题可以通过 gcc 加 -v 参数来调试</li>\n</ul>\n<h3 id=\"1-1-3-SciTools-Understand-linux\"><a href=\"#1-1-3-SciTools-Understand-linux\" class=\"headerlink\" title=\"1.1.3 SciTools Understand (linux)\"></a>1.1.3 SciTools Understand (linux)</h3><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 以 openssl 为例</span></span><br><span class=\"line\">make clean</span><br><span class=\"line\"><span class=\"built_in\">export</span> PATH=<span class=\"string\">&quot;/home/zack/code/proj/scitools/bin/linux64/buildspy:<span class=\"variable\">$PATH</span>&quot;</span></span><br><span class=\"line\"><span class=\"comment\"># 配置 CC 要在 ./config 之前</span></span><br><span class=\"line\"><span class=\"built_in\">export</span> CC=gccwrapper</span><br><span class=\"line\">./config</span><br><span class=\"line\"><span class=\"comment\"># 正确的话应该看到 buildspy 的打印</span></span><br><span class=\"line\">buildspy -db openssl.udb -verbose -cmd make</span><br><span class=\"line\"><span class=\"comment\"># 打开 openssl.udb</span></span><br><span class=\"line\"><span class=\"comment\"># project -&gt; analyze all files，点击结果的 warning 窗口中的 search for missing includes</span></span><br><span class=\"line\"><span class=\"comment\"># 把 gcc 的查找路径添加进去 echo | gcc -E -Wp,-v -</span></span><br><span class=\"line\"><span class=\"comment\"># 另外手动定义两个宏  __x86_64__ 和 __LP64__ 为了 include 64位的头文件 &lt;gnu/stubs-64.h&gt;</span></span><br></pre></td></tr></table></figure>\n\n<h3 id=\"1-1-4-Sourcetrail\"><a href=\"#1-1-4-Sourcetrail\" class=\"headerlink\" title=\"1.1.4 Sourcetrail\"></a>1.1.4 Sourcetrail</h3><p>用 compilation databases 新建项目</p>\n<ul>\n<li>linux 下用 bear 生成</li>\n<li>全平台使用 cmake 生成，<code>set(CMAKE_EXPORT_COMPILE_COMMANDS ON)</code></li>\n</ul>\n<p>参考这两个<br><a href=\"https://aul12.me/embedded/2019/05/27/cubemx-cmake.html\">https://aul12.me/embedded/2019/05/27/cubemx-cmake.html</a><br><a href=\"https://clang.llvm.org/docs/JSONCompilationDatabase.html\">https://clang.llvm.org/docs/JSONCompilationDatabase.html</a></p>\n<ul>\n<li>stm32 工程使用 cmake，从而生成 compilation databases</li>\n<li>使用 stm32 官方 ide</li>\n</ul>\n<h2 id=\"1-2-动态\"><a href=\"#1-2-动态\" class=\"headerlink\" title=\"1.2 动态\"></a>1.2 动态</h2><h3 id=\"1-2-1-KcacheGrind-linux\"><a href=\"#1-2-1-KcacheGrind-linux\" class=\"headerlink\" title=\"1.2.1 KcacheGrind (linux)\"></a>1.2.1 KcacheGrind (linux)</h3><p><a href=\"https://stackoverflow.com/questions/517589/tools-to-get-a-pictorial-function-call-graph-of-code\">tools-to-get-a-pictorial-function-call-graph-of-code</a></p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sudo apt install kcachegrind valgrind</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># Compile the program as usual, no special flags.</span></span><br><span class=\"line\"><span class=\"comment\"># 这里的调试信息和优化可以参考 工作-&gt;SDK.md 中对 openssl 的调试选项 export CC=&quot;gcc -g3 -ggdb -gdwarf-4 -fno-inline -O0 -fno-omit-frame-pointer&quot;</span></span><br><span class=\"line\">gcc -ggdb3 -O0 -o main -std=c99 main.c</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># Generate a callgrind.out.&lt;PID&gt; file.</span></span><br><span class=\"line\">valgrind --tool=callgrind ./main arg1 arg2 ...</span><br><span class=\"line\"><span class=\"comment\"># 加参数这种更全，没详细研究</span></span><br><span class=\"line\">valgrind --tool=callgrind --dump-instr=<span class=\"built_in\">yes</span> --collect-jumps=<span class=\"built_in\">yes</span> ./main arg1 arg2 ...</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># Open a GUI tool to visualize callgrind data.</span></span><br><span class=\"line\">kcachegrind callgrind.out.1234</span><br></pre></td></tr></table></figure>\n\n<ul>\n<li>可以查看<strong>最大开销</strong>的调用栈 settings -&gt; sidebars -&gt; call stack ，实际的调用栈猜测是有多条的，还是 gdb 断点看吧</li>\n<li>call graph 右键设置好 caller 和 callee depth 后（设小点，防止之后产生的图太大），右键 <a href=\"https://stackoverflow.com/questions/29449548/kcachegrind-how-to-draw-the-full-call-graph\">node cost 可以设置为 no minimum</a>，就可以看到所有的 callee 和 caller 了</li>\n<li>要看某函数调的所有函数，除了上面改 cost 的方法，还可以看下面第一栏的 Callees</li>\n<li><a href=\"https://stackoverflow.com/questions/33769323/make-callgrind-show-all-function-calls-in-the-kcachegrind-callgraph\">生成整张调用图（很大）的另一个工具</a></li>\n<li>右键可以导出成 DOT、png、jpg 文件</li>\n</ul>\n<h3 id=\"1-2-2-gcc-instrumental-linux\"><a href=\"#1-2-2-gcc-instrumental-linux\" class=\"headerlink\" title=\"1.2.2 gcc instrumental (linux)\"></a>1.2.2 gcc instrumental (linux)</h3><ul>\n<li><p><a href=\"https://stackoverflow.com/questions/517589/tools-to-get-a-pictorial-function-call-graph-of-code\">看 etrace 部分的回答</a> 、<a href=\"https://users.suse.com/~krahmer/instrumental/instrumental.pdf\">instrumental</a>，这两个程序使用查找 elf 程序中符号“地址”与“名称“ map 的方式生成调用关系，通过调试 instrument 附带的 C 代码发现，linux 上 __cyg_profile_func_enter 传入的函数指针地址与符号表中的不同，<a href=\"https://jvns.ca/blog/2018/01/09/resolving-symbol-addresses/\">可能的原因 (这篇文章是通过符号名查地址)</a></p>\n</li>\n<li><p>所以基于 instrumental 的代码改进，使用 <a href=\"https://unix.stackexchange.com/questions/386747/tool-to-print-out-functions-being-called-during-run-time\">dladdr</a> 接口获得地址对应的符号名，除了 <code>-finstrument-functions</code>，还要加 <code>-O0 -rdynamic -ldl</code>，不用加 <code>-g</code></p>\n</li>\n<li><p>类似的还有 <a href=\"https://stackoverflow.com/a/351980\">backtrace_symbols</a></p>\n</li>\n<li><p>代码见 instrumental 文件夹，目前还<strong>不支持多线程</strong>，没有锁和分线程统计</p>\n  <figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">gcc -shared -fPIC -Wall inst.c -o inst.so -ldl</span><br><span class=\"line\">gcc -rdynamic -finstrument-functions -O0 -o code code.c</span><br><span class=\"line\">LD_PRELOAD=/home/inst.so ./code</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 以 openssl 为例，openssl 因为有 static 函数，所以效果不太好</span></span><br><span class=\"line\"><span class=\"built_in\">export</span> CC=<span class=\"string\">&quot;gcc -rdynamic -finstrument-functions -O0 &quot;</span></span><br><span class=\"line\">./config</span><br></pre></td></tr></table></figure>\n</li>\n<li><p>TODO 想支持多线程，把 openssl 的图画出来，把 static 函数批量替换会怎样？可参考 github 上 <a href=\"https://github.com/finaldie/ftracer\">ftracer</a></p>\n</li>\n</ul>\n<h2 id=\"1-3-手绘\"><a href=\"#1-3-手绘\" class=\"headerlink\" title=\"1.3 手绘\"></a>1.3 手绘</h2><ul>\n<li><a href=\"https://zhuanlan.zhihu.com/p/31757959\">xmind 的逻辑图</a>，比起 mindmaster 没有节点数目的限制，可以一个文件创建多个画布，免费导出 svg</li>\n</ul>\n<h1 id=\"2-内存占用\"><a href=\"#2-内存占用\" class=\"headerlink\" title=\"2 内存占用\"></a>2 内存占用</h1><p>valgrind-3.16.1 交叉编译，<a href=\"https://blog.csdn.net/sunqian666888/article/details/84454844\">参考</a></p>\n<ul>\n<li><a href=\"https://www.valgrind.org/info/platforms.html\">Supported Platforms</a>，对 kernel 和 glibc 的版本有要求</li>\n<li>–prefix 的路径要和最终运行的路径一致</li>\n<li>修改 configure  <code>armv7*)</code> 改为 <code>armv7*|arm*)</code></li>\n<li>.&#x2F;configure –prefix&#x3D;&#x2F;data&#x2F;update&#x2F;valgrind –host&#x3D;arm-linux-gnueabi , make, make install</li>\n<li>精简 lib&#x2F;valgrind 目录下文件 <code>rm callgrind-arm-linux helgrind-arm-linux cachegrind-arm-linux dhat-arm-linux drd-arm-linux lackey-arm-linux exp-bbv-arm-linux</code>，减少占用</li>\n<li>要统计的程序使用 -g 编译，-O 优化等级不重要，不会影响堆内存统计</li>\n<li>获得最大栈深，根据手册所说栈采样会慢 &#x2F;data&#x2F;update&#x2F;valgrind&#x2F;bin&#x2F;valgrind –tool&#x3D;massif –heap&#x3D;no –stacks&#x3D;yes .&#x2F;sdk 。但这样无法得到最大栈深的调用栈，将线程的栈故意比最大栈深小一些，使用 gdb 调试，得到触发 stackoverflow 的地方。实测，用 ulimit -s 调用栈打不出来</li>\n</ul>\n<p><a href=\"https://valgrind.org/docs/manual/ms-manual.html\">valgrind Massif官方文档</a></p>\n<p>栈统计的几种方法</p>\n<p><a href=\"https://www.embedded.com/mastering-stack-and-heap-for-system-reliability-part-2-properly-allocating-stacks/\">Properly allocating stacks，这篇文章一共 3 部分</a>、<a href=\"https://embeddedgurus.com/stack-overflow/2009/03/computing-your-stack-size/\">Computing your stack size</a> ，google ”find max stack depth by stack overflow“ 可以看到 keil 和 IAR 的文章，linux 平台上能想到的办法是改 massif 的源码来记录 detailed snapshot</p>\n<h1 id=\"3-调试\"><a href=\"#3-调试\" class=\"headerlink\" title=\"3 调试\"></a>3 调试</h1><h2 id=\"3-1-gdb\"><a href=\"#3-1-gdb\" class=\"headerlink\" title=\"3.1 gdb\"></a>3.1 gdb</h2><p><a href=\"https://www.linux.com/news/remote-cross-target-debugging-gdb-and-gdbserver/\">https://www.linux.com/news/remote-cross-target-debugging-gdb-and-gdbserver/</a></p>\n<p><a href=\"https://sourceware.org/gdb/wiki/BuildingCrossGDBandGDBserver%EF%BC%8C%E5%8C%85%E5%90%AB\">https://sourceware.org/gdb/wiki/BuildingCrossGDBandGDBserver，包含</a> host、target 解释</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 记得装这个</span></span><br><span class=\"line\">sudo apt-get install texinfo</span><br><span class=\"line\"><span class=\"comment\"># 可以创建不同的 build 文件夹来编译</span></span><br><span class=\"line\"><span class=\"comment\"># gdb &amp; gdbserver</span></span><br><span class=\"line\">../configure --host=mipsel-openwrt-linux --prefix=/home/zack/code/proj/gdb_install</span><br><span class=\"line\"><span class=\"comment\"># gdb</span></span><br><span class=\"line\">../configure --with-expat --target=mipsel-openwrt-linux --prefix=/home/zack/code/proj/gdbonly_install</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"3-1-1-gdbserver\"><a href=\"#3-1-1-gdbserver\" class=\"headerlink\" title=\"3.1.1 gdbserver\"></a>3.1.1 gdbserver</h3><ul>\n<li>传入环境变量方法<ul>\n<li>sudo gdbserver –wrapper env ‘LD_LIBRARY_PATH&#x3D;&#x2F;lib&#x2F;libpcap&#x2F;lib’ –  :1234 .&#x2F;tiny</li>\n</ul>\n</li>\n</ul>\n<h3 id=\"3-1-2-修改\"><a href=\"#3-1-2-修改\" class=\"headerlink\" title=\"3.1.2 修改\"></a>3.1.2 修改</h3><p>为了编译通过做得修改，ubuntu 18.04 环境。基于 master 分支 <code>ee6d95574b 2019-09-04  (HEAD -&gt; master, origin/master, origin/HEAD) Automatic date update in version.in</code></p>\n<p><a href=\"/%E8%99%9A%E6%8B%9F%E7%8E%AF%E5%A2%83/3.%20%E5%A4%84%E7%90%86%E5%B7%A5%E5%85%B7/%E4%BB%A3%E7%A0%81%E5%88%86%E6%9E%90/../%E4%BB%A3%E7%A0%81%E5%88%86%E6%9E%90/gdb-20190904-ee6d95574b.diff\">diff 文件</a></p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 拷贝到源码目录，使用 patch </span></span><br><span class=\"line\">patch -p1 &lt;patch.diff</span><br></pre></td></tr></table></figure>\n\n\n\n<h3 id=\"3-1-3-调试\"><a href=\"#3-1-3-调试\" class=\"headerlink\" title=\"3.1.3 调试\"></a>3.1.3 调试</h3><p><a href=\"https://wizardforcel.gitbooks.io/100-gdb-tips/set-print-pretty-on.html\">100 个 gdb技巧</a></p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">gdbserver &lt;host-ip&gt;:2345 tinyeye </span><br><span class=\"line\"></span><br><span class=\"line\">./mipsel-openwrt-linux-gdb tinyeye</span><br><span class=\"line\">target remote 192.168.37.1:2345</span><br><span class=\"line\"><span class=\"built_in\">continue</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 每行打印一个结构体成员</span></span><br><span class=\"line\"><span class=\"built_in\">set</span> <span class=\"built_in\">print</span> pretty on</span><br><span class=\"line\">p *(struct list_head *)0x469594</span><br></pre></td></tr></table></figure>\n\n<p><a href=\"https://www.cprogramming.com/debugging/segfaults.html\">segfaults 常见定位方法</a></p>\n<p><a href=\"https://github.com/2-3-5-7/2-3-5-7.github.io/tree/main/虚拟环境/3. 处理工具/代码分析\"><i class=\"fa-solid fa-download fa-2xl\" style=\"color: gray;\"></i></a></p>\n",
            "tags": []
        },
        {
            "id": "https://synrst.de/%E8%99%9A%E6%8B%9F%E7%8E%AF%E5%A2%83/3.%20%E5%A4%84%E7%90%86%E5%B7%A5%E5%85%B7/%E7%94%B5%E5%AD%90%E4%B9%A6%E5%A4%84%E7%90%86/",
            "url": "https://synrst.de/%E8%99%9A%E6%8B%9F%E7%8E%AF%E5%A2%83/3.%20%E5%A4%84%E7%90%86%E5%B7%A5%E5%85%B7/%E7%94%B5%E5%AD%90%E4%B9%A6%E5%A4%84%E7%90%86/",
            "title": "电子书处理",
            "date_published": "1970-01-01T00:00:00.000Z",
            "content_html": "<h1 id=\"1-扫描书\"><a href=\"#1-扫描书\" class=\"headerlink\" title=\"1 扫描书\"></a>1 扫描书</h1><p>参考 asset 中《DIY版简易零边距扫描仪之玻璃夹子方案》</p>\n<h2 id=\"1-1-用到的工具\"><a href=\"#1-1-用到的工具\" class=\"headerlink\" title=\"1.1 用到的工具\"></a>1.1 用到的工具</h2><p><strong>下次试试室内灯光，之前的侧光对于不那么白的纸太暗了</strong></p>\n<ul>\n<li>玻璃板，超白玻璃 8mm 厚，300 X 250，不要印 3C 标志</li>\n<li>俯拍架，不用带补光灯</li>\n<li>蓝牙遥控器</li>\n<li>ComicEnhancerPro_chn 文件处理</li>\n<li>Foxit 高级 PDF，PDF 制作和 OCR</li>\n<li>FreePic2Pdf 书签制作</li>\n</ul>\n<h2 id=\"1-2-拍摄\"><a href=\"#1-2-拍摄\" class=\"headerlink\" title=\"1.2 拍摄\"></a>1.2 拍摄</h2><ul>\n<li>不一定要找专门的光源，室内灯光不反光也可</li>\n<li>书架第二格，俯拍架足够高，支架手臂与书架平行</li>\n<li>开启拍照声音</li>\n<li>开启长焦镜头，减少畸变</li>\n<li>固定焦距，避免自动对焦模糊</li>\n<li>高质量照片模式</li>\n<li>开启网格线，保证书的文字不倾斜</li>\n<li>增加手机锁屏时间</li>\n<li>两个书架的宽度比书脊稍宽，避免位置移动，同时也方便翻页</li>\n<li>调整到没有大的反光，另一页的反光可以用白纸遮盖（或调整光源？），手机边缘反光用创可贴遮住</li>\n<li>书籍摆放位置划线，避免位置移动</li>\n<li>拍摄完先不移动灯光和相机位置，准备对个别不满意的页面补拍</li>\n</ul>\n<h2 id=\"1-3-文件处理\"><a href=\"#1-3-文件处理\" class=\"headerlink\" title=\"1.3 文件处理\"></a>1.3 文件处理</h2><ul>\n<li>文件重命名，同时检查是否漏拍</li>\n<li>图像裁剪，随着厚度增加每张会有细微的偏移，因此图片可能要分多个文件夹裁剪多次</li>\n<li>图像处理，封面单独处理<ul>\n<li>彩色 300 DPI<ul>\n<li>纠斜: 自动_横排, 边缘扩展</li>\n<li>照度修正</li>\n<li>自动对比1</li>\n<li>亮度: 113</li>\n<li>表面模糊: 遍数&#x3D;1, 算法&#x3D;Photoshop, 半径&#x3D;5, 阀值&#x3D;20</li>\n<li>USM锐化: 遍数&#x3D;1, 数量&#x3D;50, 半径&#x3D;1.0, 阀值&#x3D;0</li>\n</ul>\n</li>\n<li>黑白 600 DPI（封面彩色 600 DPI）<ul>\n<li>纠斜: 自动_横排, 边缘保留</li>\n<li>切边: DPI&#x3D;600</li>\n<li>照度修正</li>\n<li>自动对比1</li>\n<li>USM锐化: 遍数&#x3D;1, 数量&#x3D;50, 半径&#x3D;1.0, 阀值&#x3D;0</li>\n<li>色彩设置: 色彩数&#x3D;纯黑白, 纯黑白（二值化）选项: 阀值算法&#x3D;Wolf, 窗口尺寸&#x3D;50, 去斑直径&#x3D;2, 去除与边缘接触的黑色区域, 边缘去毛刺</li>\n</ul>\n</li>\n</ul>\n</li>\n</ul>\n<h1 id=\"2-PDF-处理\"><a href=\"#2-PDF-处理\" class=\"headerlink\" title=\"2 PDF 处理\"></a>2 PDF 处理</h1><h2 id=\"2-1-制作\"><a href=\"#2-1-制作\" class=\"headerlink\" title=\"2.1 制作\"></a>2.1 制作</h2><ul>\n<li>Foxit 高级 PDF 的文件合并和 OCR</li>\n<li>书签 FreePic2Pdf</li>\n</ul>\n<h2 id=\"2-2-去水印\"><a href=\"#2-2-去水印\" class=\"headerlink\" title=\"2.2 去水印\"></a>2.2 去水印</h2><ul>\n<li>Foxit 高级 PDF 能识别出水印，去除即可</li>\n<li>Foxit 高级 PDF，删除一个文本对象，保存后，虽然看上去其它文本对象还在，但已经删除了</li>\n<li><a href=\"https://meta.appinn.net/t/topic/16983/20\">AcrobatDCd2000920063 + Enfocus PitStop Pro 2020</a> 没试过，好像很强大，<a href=\"https://www.bilibili.com/s/video/BV1mh411Q74Y\">视频介绍</a></li>\n</ul>\n<h2 id=\"2-3-书签\"><a href=\"#2-3-书签\" class=\"headerlink\" title=\"2.3 书签\"></a>2.3 书签</h2><ul>\n<li>自动添加书签<ul>\n<li>用 PDF 补丁丁 根据样式识别标题，然后手动调整，见 <a href=\"https://www.cnblogs.com/pdfpatcher/p/8452025.html\">作者博客教程</a></li>\n</ul>\n</li>\n<li>手动改书签<ul>\n<li>先提取书签，然后编辑 FreePic2Pdf.itf 和 FreePic2Pdf_bkmk.txt，最后挂书签 目录可从豆瓣或其它 PDF 中提取</li>\n<li>用 PdgCntEditor 调整页码偏移量 FreePic2Pdf.itf 设置 BasePage 目录页码基准（一般与 TextPage 相同），ContentsPage 目录绝对页码，TextPage 正文绝对页码，见 FreePic2Pdf 帮助文档中的接口文件格式说明 FreePic2Pdf_bkmk.txt 为书签，tab 控制目录层级，标题与页码间 tab 分隔，页码基准前的页面用负数表示 notepad++ 常用正则，添加二级标题缩进 <code>^(\\d+.\\d+)</code> 替换为 <code>\\t\\1</code>。添加标题与页码的 tab，<code>\\s+(\\d+)$</code> 替换为 <code>\\t\\1</code></li>\n<li><a href=\"https://www.cnblogs.com/stronghorse/\">软件作者博客</a></li>\n</ul>\n</li>\n</ul>\n<h2 id=\"2-4-模糊pdf变清晰\"><a href=\"#2-4-模糊pdf变清晰\" class=\"headerlink\" title=\"2.4 模糊pdf变清晰\"></a>2.4 模糊pdf变清晰</h2><ul>\n<li><a href=\"https://cloud.tencent.com/developer/news/25259\">模糊pdf变清晰</a> 先提取一张图片，尝试调整参数，然后再批量处理</li>\n</ul>\n<h2 id=\"2-5-HTML-转-PDF\"><a href=\"#2-5-HTML-转-PDF\" class=\"headerlink\" title=\"2.5 HTML 转 PDF\"></a>2.5 HTML 转 PDF</h2><p>单个 HTML 转 PDF</p>\n<ol>\n<li>为了保留书签，另存为 HTML，并用 word 打开</li>\n<li>ALT + F9 批量修改超链接指向当前文档而非网址，一般是删除网址部分，只保留标题指向</li>\n<li>另存为 PDF，选项中保留书签</li>\n</ol>\n<h1 id=\"3-epub-等阅读器格式处理\"><a href=\"#3-epub-等阅读器格式处理\" class=\"headerlink\" title=\"3 epub 等阅读器格式处理\"></a>3 epub 等阅读器格式处理</h1><h2 id=\"3-1-转换\"><a href=\"#3-1-转换\" class=\"headerlink\" title=\"3.1 转换\"></a>3.1 转换</h2><ul>\n<li>格式 azw3，可支持自定义字体，mobi 格式(new、old、both) 都不支持。两种选择<ol>\n<li>需要书籍、笔记同步功能，但无法显示封面。用 calibre 转换为 mobi both 格式（old 格式会被转为 azw，new 格式不让发送），然后使用邮箱发送。此时 amazon 会转为 azw3，由于是 PDOC 类型所以无法显示封面。如 kindle 下载后用 MobiMetaEditor 改为 EBOK 类型则会导致文档无法同步，参见 <a href=\"https://bookfere.com/post/668.html\">为何推送 KF8 标准 MOBI 电子书不显示封面</a>。有趣的是此时 App 端可以显示封面</li>\n<li>不需要同步功能，可以显示封面。用 calibre 转换为 azw3，发送到 kindle，实际上是将封面放入 <code>kindle:\\system\\thumbnails\\thumbnail_ASIN_EBOK_portrait.jpg</code>，对于中文书籍还需将拼音文件名改回，参见 <a href=\"https://mayanbin.com/post/setting-covers-for-kindle.html\">两种方法来给 Kindle 设置图书封面</a></li>\n</ol>\n</li>\n<li>有些书籍打开卡死，重新设置文本编码为 utf-8</li>\n<li>calibre 中文书籍处理<ul>\n<li>首选项–保存图书到磁盘，去掉3个勾选项，分别是：分别保存封面、使用OPF文件保存元数据、将非英语字符转换为对应英语字符</li>\n<li>在保存模板中将内容改为： {title}。如果标题不对也需要修改</li>\n<li>保存设置，以后使用时选择<code>保存图书到磁盘</code>方式</li>\n</ul>\n</li>\n</ul>\n<h2 id=\"3-2-移除硬回车\"><a href=\"#3-2-移除硬回车\" class=\"headerlink\" title=\"3.2 移除硬回车\"></a>3.2 移除硬回车</h2><ul>\n<li>使用 calibre 的启发式处理，“取消换行因子”来移除</li>\n<li>使用 amazon 发邮件 convert 方式，转换 pdf 为 azw3（弊端是回车替换为了空格，没有目录），但此时打开会导致 kindle 卡死，需要再用 calibre 设置输入文本编码为 utf-8</li>\n<li>更麻烦的方法是，使用正则表达式，转换成 docx 处理完再转回来</li>\n</ul>\n<h2 id=\"3-3-去-DRM\"><a href=\"#3-3-去-DRM\" class=\"headerlink\" title=\"3.3 去 DRM\"></a>3.3 去 DRM</h2><ul>\n<li><p>Kindle</p>\n<ul>\n<li>两种方法都要用 1.24 的 kindle for pc（安装文件在 windows 环境-不常用中），<a href=\"https://www.epubor.com/faq.html?utm_medium=soft&utm_source=kindle_version&utm_campaign=kindle&utm_content=EpuborDRMRemovalv1.0.17.820_28888-0#e108\">All DRM Removal 的解释</a>，并找到下载的电子书 <code>我的文档\\My Kindle Content\\ASIN_EBOK</code></li>\n</ul>\n<p><img src=\"/%E8%99%9A%E6%8B%9F%E7%8E%AF%E5%A2%83/3.%20%E5%A4%84%E7%90%86%E5%B7%A5%E5%85%B7/%E7%94%B5%E5%AD%90%E4%B9%A6%E5%A4%84%E7%90%86/../%E7%94%B5%E5%AD%90%E4%B9%A6%E5%A4%84%E7%90%86/%E7%89%88%E6%9C%AC%E6%8F%90%E7%A4%BA.png\"></p>\n<ul>\n<li><a href=\"https://github.com/noDRM/DeDRM_tools\">新版DeDRM_tools</a>，<a href=\"https://github.com/apprenticeharper/DeDRM_tools/releases/\">旧版</a> 下载 zip 包，安装插件，设置序列号，拖到 Calibre 中，<a href=\"https://www.mzihen.com/kindle-drm-removal/\">参考</a><ul>\n<li>All DRM Removal for Windows 终身版，224。感觉这个就是 DeDRM 的图形封装。用  <code>All DRM Removal for Windows</code> 破解版，keygen 会报木马，在沙盒中打开获取注册信息即可，切换到 kindle 进行破解</li>\n</ul>\n</li>\n<li>租借书籍 <a href=\"https://www.reddit.com/r/Piracy/comments/ezenaa/how_to_remove_drm_from_an_amazon_kindle_rented/\">注释掉 rented 两行代码</a> 后可以用，已经加入改后版本</li>\n</ul>\n</li>\n<li><p>Google Books，用到 ADE_2.0，装 .net 3.5，Calibre 的 DeDRM 添加 default_key（与 ADE 装在一个系统），拖动下载的 PDF 到 Calibre 自动解密</p>\n</li>\n</ul>\n<h2 id=\"3-4-繁简转换\"><a href=\"#3-4-繁简转换\" class=\"headerlink\" title=\"3.4 繁简转换\"></a>3.4 繁简转换</h2><p><a href=\"https://peggy918.pixnet.net/blog/post/468475997-%E3%80%90calibre%E5%A4%96%E6%8E%9B%E3%80%91-%E7%B0%A1%E8%BD%89%E7%B9%81\">【Calibre外挂】 简转繁功能大揭密</a>、<a href=\"https://bookfere.com/post/162.html\">Calibre 使用教程之电子书繁体字转简体字</a></p>\n<ol>\n<li>Calibre 安装 <code>Chinese Text Conversion</code> 插件，编辑书籍，点击<code>文</code>，台湾繁转简，直排转横排，保存副本后</li>\n<li>再用编辑单个书籍，加载 csr 替换文件（见资源目录），前面的 4 个引号替换可以删除</li>\n<li>对于带图片的文档（漫画），输出配置选择 tablet，不改变图片质量</li>\n</ol>\n<p>步骤 1 要先于 2 因为直接替换直排的文字输出有问题</p>\n<h2 id=\"3-5-生成目录\"><a href=\"#3-5-生成目录\" class=\"headerlink\" title=\"3.5 生成目录\"></a>3.5 生成目录</h2><ul>\n<li>编辑书籍，工具 – 目录 – 编辑目录，里面有各种生成目录的方式</li>\n</ul>\n<p><a href=\"https://github.com/2-3-5-7/2-3-5-7.github.io/tree/main/虚拟环境/3. 处理工具/电子书处理\"><i class=\"fa-solid fa-download fa-2xl\" style=\"color: gray;\"></i></a></p>\n",
            "tags": []
        },
        {
            "id": "https://synrst.de/%E8%99%9A%E6%8B%9F%E7%8E%AF%E5%A2%83/3.%20%E5%A4%84%E7%90%86%E5%B7%A5%E5%85%B7/office/",
            "url": "https://synrst.de/%E8%99%9A%E6%8B%9F%E7%8E%AF%E5%A2%83/3.%20%E5%A4%84%E7%90%86%E5%B7%A5%E5%85%B7/office/",
            "title": "office",
            "date_published": "1970-01-01T00:00:00.000Z",
            "content_html": "<p>表格快速添加多个新行，鼠标放在表格外的换行位置，回车添加新行，按 F4 多次重复添加 </p>\n<p>将表格选中行下移，Alt + Shift + 下</p>\n",
            "tags": []
        },
        {
            "id": "https://synrst.de/%E8%99%9A%E6%8B%9F%E7%8E%AF%E5%A2%83/3.%20%E5%A4%84%E7%90%86%E5%B7%A5%E5%85%B7/%E9%9F%B3%E8%A7%86%E9%A2%91%E5%AD%A6%E4%B9%A0%E4%B8%8E%E5%A8%B1%E4%B9%90/",
            "url": "https://synrst.de/%E8%99%9A%E6%8B%9F%E7%8E%AF%E5%A2%83/3.%20%E5%A4%84%E7%90%86%E5%B7%A5%E5%85%B7/%E9%9F%B3%E8%A7%86%E9%A2%91%E5%AD%A6%E4%B9%A0%E4%B8%8E%E5%A8%B1%E4%B9%90/",
            "title": "音视频学习与娱乐",
            "date_published": "1970-01-01T00:00:00.000Z",
            "content_html": "<h1 id=\"1-应对禁止录屏\"><a href=\"#1-应对禁止录屏\" class=\"headerlink\" title=\"1 应对禁止录屏\"></a>1 应对禁止录屏</h1><ul>\n<li>添加虚拟显示器，将视频传送给另一端后，用另一端的软件录屏<ul>\n<li>HDMI 欺骗器</li>\n<li>spacedesk</li>\n<li>视频采集卡</li>\n<li>用 QQ 远程协助、远程桌面、虚拟机也是这个思路，即绕过软件层面的检测</li>\n</ul>\n</li>\n<li>也可找没被检测到的录屏软件</li>\n<li>保险起见，每天录屏时间不要超过一个合理时间，如 8h</li>\n<li>Potplayer 录屏没声音时，打开 - 设备设置 - 摄像头 - 音频录制设备 - 数字音频接口。视频 –&gt; 录制视频(ALT + C)，保持默认MPEG-4编码，勾选开启高质量视频压缩，然后把播放器静音，最小化</li>\n</ul>\n<h1 id=\"2-手机控制-PC\"><a href=\"#2-手机控制-PC\" class=\"headerlink\" title=\"2 手机控制 PC\"></a>2 手机控制 PC</h1><ul>\n<li>spacedesk 作为扩展显示器</li>\n</ul>\n<h1 id=\"3-PC-控制手机\"><a href=\"#3-PC-控制手机\" class=\"headerlink\" title=\"3 PC 控制手机\"></a>3 PC 控制手机</h1><ul>\n<li>用 QtScrcpy 的“熄屏”控制，可以用于 App 开发</li>\n</ul>\n<h1 id=\"4-内录声音\"><a href=\"#4-内录声音\" class=\"headerlink\" title=\"4 内录声音\"></a>4 内录声音</h1><ul>\n<li>静音内录某个软件的声音<ul>\n<li>装虚拟声卡 Virtual Audio Cable(VAC)</li>\n<li>在“音量合成器”中，将要被录音的软件输出给声卡一端</li>\n<li>录音软件录制虚拟声卡的另一端</li>\n</ul>\n</li>\n<li>如果不静音，要同时听到声音，在声音 – 录制 – CABLE Output 中勾选侦听此设备，选择播放设备</li>\n<li>“立体声混音”也能做到内录系统声音，但有的系统没有</li>\n</ul>\n<h1 id=\"5-音频实时翻译（同传）\"><a href=\"#5-音频实时翻译（同传）\" class=\"headerlink\" title=\"5 音频实时翻译（同传）\"></a>5 音频实时翻译（同传）</h1><ul>\n<li>参考，阿虚“无字幕视频实时翻译”<ul>\n<li>手机系统自带，小米、华为 AI 字幕。可通过上面的“PC 控制手机”，将同传翻译画面传给 PC</li>\n<li>翻译 App，有道翻译官（唯一支持日语的）、Google 翻译、百度翻译、腾讯翻译官</li>\n<li>飞书，会议功能，字幕和翻译（支持日语）。声音输入可用两种方法<ul>\n<li>用蓝牙耳机的麦克风，放在音箱前</li>\n<li>用上面介绍的“内录声音”的方法</li>\n</ul>\n</li>\n<li>也可识别出字幕后，用 OCR 翻译</li>\n</ul>\n</li>\n</ul>\n<h1 id=\"6-转文字\"><a href=\"#6-转文字\" class=\"headerlink\" title=\"6 转文字\"></a>6 转文字</h1><ul>\n<li>借助视频软件 剪映 生成字幕后，用 <a href=\"https://jy.mzh.ren/\">字幕提取工具</a>、剪映工具箱<ul>\n<li>必剪 也有免费的语言识别，用工具导出</li>\n<li>Pr 有语言识别，但盗版可能无法用</li>\n</ul>\n</li>\n<li>借助会议记录软件<ul>\n<li><a href=\"https://www.feishu.cn/product/minutes\">飞书妙记</a> 免费 100G 容量，不够时可以删掉，导入视频，导出 SRT</li>\n<li>钉钉闪记也类似</li>\n</ul>\n</li>\n<li>调云服务 API<ul>\n<li><a href=\"https://github.com/1c7/Translate-Subtitle-File\">字幕组机翻小助手</a> 能用的 API 接口多，但免费版有 10h&#x2F;月 额度</li>\n<li><a href=\"https://github.com/BingLingGroup/autosub\">autosub</a> 可用 Google、百度、讯飞</li>\n<li>pyTranscriber，要开全局代理，速度一般，只有 Google</li>\n</ul>\n</li>\n<li>Youtube 为视频自动生成字幕，先将音频转为视频才能上传<ul>\n<li><code>ffmpeg -f lavfi -i color=c=black:s=1280x720:r=5 -i audio.mp3 -crf 0 -c:a copy -shortest output.mp4</code></li>\n<li>不支持中文</li>\n</ul>\n</li>\n<li>其它思路<ul>\n<li><a href=\"https://studio.xiaoyuzhoufm.com/\">小宇宙 studio 工具</a> 只能用在 PC 查看，不是 SRT 字幕</li>\n<li>手机、office、chrome 实时语言识别或录音转文字，然后利用 youtube 自动对齐时间，生成字幕</li>\n</ul>\n</li>\n<li>用播客，喜马拉雅、微信听书</li>\n<li>总结<ul>\n<li>对播客，选支持播客的 app</li>\n<li>对知识学习，严肃类<ul>\n<li>对中文，用飞书妙记或免费的剪辑软件</li>\n<li>对英文，传到 youtube 保存，并自动生成字幕，如为了字幕可只传音频</li>\n<li>对小语种、方言，用机翻助手里的免费额度</li>\n<li>步骤，下载、转写文字、划分框架、记录笔记、备份保存<ul>\n<li>统一保存为 youtube 私有视频，并在视频描述中附上时间轴章节、笔记</li>\n<li>飞书妙记也可考虑，100G 空间</li>\n</ul>\n</li>\n</ul>\n</li>\n</ul>\n</li>\n</ul>\n<h1 id=\"7-听音乐\"><a href=\"#7-听音乐\" class=\"headerlink\" title=\"7 听音乐\"></a>7 听音乐</h1><table>\n<thead>\n<tr>\n<th>指标</th>\n<th>目的</th>\n<th>指标权重</th>\n<th>Youtube</th>\n<th>listen1</th>\n<th>MusicTools</th>\n<th>Spotify</th>\n<th>QQ 音乐</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>歌曲数量</td>\n<td>找旧歌</td>\n<td>3</td>\n<td>3</td>\n<td>2</td>\n<td></td>\n<td>1</td>\n<td>2</td>\n</tr>\n<tr>\n<td>音乐推荐</td>\n<td>找新歌</td>\n<td>3</td>\n<td>3</td>\n<td>1</td>\n<td></td>\n<td>2</td>\n<td>2</td>\n</tr>\n<tr>\n<td>音质</td>\n<td>体验</td>\n<td>2</td>\n<td>2</td>\n<td>1</td>\n<td></td>\n<td>3</td>\n<td>3</td>\n</tr>\n<tr>\n<td>离线播放</td>\n<td>省流量</td>\n<td>1</td>\n<td>0</td>\n<td>0</td>\n<td></td>\n<td>3</td>\n<td>3</td>\n</tr>\n<tr>\n<td>下载</td>\n<td>备份防删除</td>\n<td>1</td>\n<td>0</td>\n<td>0</td>\n<td></td>\n<td>0</td>\n<td>0</td>\n</tr>\n<tr>\n<td>界面、跨终端同步</td>\n<td>易用</td>\n<td>2</td>\n<td>3</td>\n<td>2</td>\n<td></td>\n<td>3</td>\n<td>2</td>\n</tr>\n<tr>\n<td>优势</td>\n<td></td>\n<td></td>\n<td>歌曲全且可自己扩展</td>\n<td>可跨平台听国内的歌</td>\n<td>可下载高品质导入到 Youtube</td>\n<td></td>\n<td></td>\n</tr>\n</tbody></table>\n<ul>\n<li>对没有的国内音乐或想收藏的音乐，用 Listen1（跨平台搜索工具） 找到想要的，用 MusicTools（无损下载） 等工具下 320K MP3&#x2F;256K AAC，传到 Google Drive（备份） 和 Youtube Music（方便在线听） 各一份</li>\n<li>国内外平台都存在版权限制导致歌曲不全的问题，次要问题是无法下载收藏某首歌。Youtube 开放的平台配合搜索、下载工具来解决</li>\n<li>Youtube music 歌词插件 <a href=\"https://github.com/mantou132/Spotify-Lyrics\">Spotify Lyrics</a></li>\n</ul>\n",
            "tags": []
        },
        {
            "id": "https://synrst.de/%E8%99%9A%E6%8B%9F%E7%8E%AF%E5%A2%83/3.%20%E5%A4%84%E7%90%86%E5%B7%A5%E5%85%B7/%E7%BC%96%E8%AF%91%E5%B7%A5%E5%85%B7/",
            "url": "https://synrst.de/%E8%99%9A%E6%8B%9F%E7%8E%AF%E5%A2%83/3.%20%E5%A4%84%E7%90%86%E5%B7%A5%E5%85%B7/%E7%BC%96%E8%AF%91%E5%B7%A5%E5%85%B7/",
            "title": "编译工具",
            "date_published": "1970-01-01T00:00:00.000Z",
            "content_html": "<ul>\n<li><a href=\"/%E8%99%9A%E6%8B%9F%E7%8E%AF%E5%A2%83/3.%20%E5%A4%84%E7%90%86%E5%B7%A5%E5%85%B7/%E7%BC%96%E8%AF%91%E5%B7%A5%E5%85%B7/../Makefile.pdf\">跟我一起写Makefile</a></li>\n<li>《嵌入式 Linux C 语言程序设计》，make</li>\n</ul>\n<h1 id=\"1-CMake\"><a href=\"#1-CMake\" class=\"headerlink\" title=\"1 CMake\"></a>1 CMake</h1><ul>\n<li><p>推荐 out of source builds，输出不混在一起，git 工具好管理，可以创建多个 build，如 debug&#x2F;release。build 与 source 同一等级，不在 source 内部</p>\n</li>\n<li><p>在多个平台测试以避免写出平台相关的 cmake</p>\n</li>\n<li><p>选择编译器和 Generator，两者不同搭配可有不同的 build 目录，只需指定一次</p>\n  <figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">cmake -B build -G <span class=\"string\">&quot;MinGW Makefiles&quot;</span> -D CMAKE_MAKE_PROGRAM=<span class=\"string\">&quot;D:/soft/mingw64/bin/mingw32-make.exe&quot;</span></span><br></pre></td></tr></table></figure></li>\n<li><p>生成和编译始终在源码根目录</p>\n  <figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 生成 build system</span></span><br><span class=\"line\">cmake -B build</span><br><span class=\"line\"><span class=\"comment\"># 编译</span></span><br><span class=\"line\">cmake --build build</span><br><span class=\"line\"><span class=\"comment\"># verbose and N parallel build</span></span><br><span class=\"line\">cmake --build build -v -j N</span><br><span class=\"line\"><span class=\"comment\"># 列出 target</span></span><br><span class=\"line\">cmake --build build -t <span class=\"built_in\">help</span></span><br><span class=\"line\"><span class=\"comment\"># 编译 target</span></span><br><span class=\"line\">cmake --build build -t Tutorial</span><br><span class=\"line\">cmake --build /pathTo/build --config Debug --target MyApp</span><br><span class=\"line\"><span class=\"comment\"># 列出可设置的选项</span></span><br><span class=\"line\">cmake -LH build</span><br><span class=\"line\"><span class=\"comment\"># 设置选项</span></span><br><span class=\"line\">- </span><br></pre></td></tr></table></figure></li>\n<li><p>调试 CMake</p>\n  <figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 用 --trace 打印太多了，所以一般 --trace-source 指定源码根目录的 CMakeLists.txt</span></span><br><span class=\"line\">cmake -B build --trace-source=<span class=\"string\">&quot;CMakeLists.txt&quot;</span> -DUSE_MYMATH:BOOL=OFF</span><br></pre></td></tr></table></figure></li>\n<li><p>target 可以是虚拟的</p>\n</li>\n<li><p>变量都是字符串类型，值有空格要加引号，多个值用分号连起来。未定义的变量是空字符串。${} 可以嵌套引用，可作为变量名</p>\n</li>\n<li><p>unset(myVar) &#x2F; set(myVar) 用来 unset 变量</p>\n</li>\n<li><p>ENV{varName} 修改环境变量，环境变量只影响这次 cmake 执行</p>\n</li>\n<li><p>cache 和普通变量同名，普通变量会掩盖 cache 变量，但在一些情况 P26 会相反，cache 变量会被使用。正因为有同名情况，所以要给一个变量明确置空 set(foo “”) 而非使用 unset(foo)</p>\n</li>\n<li><p>cache 变量的修改需要 force 关键字</p>\n</li>\n<li><p>命令行定义 cache 变量，建议指定类型；-U 取消定义</p>\n</li>\n<li><p>cmake-gui 一直 （配置 + 点 Configure） 直到没有红色然后点 Generate</p>\n</li>\n<li><p>给 cache 变量一个下划线结尾的前缀方便 cmake-gui 分组，项目相关的也用前缀方便以后给其它项目使用</p>\n</li>\n<li><p>文件的 IS_NEWER_THAN 要用 NOT 方式使用，因为 P44</p>\n</li>\n<li><p>不使用加引号的字符串，避免 3.1 以下版本解释为变量，进行变量替换</p>\n</li>\n<li><p>函数传参，引号分割的字符串会被当作不同的参数，要注意何时用引号括起来</p>\n</li>\n<li><p>尽量用函数而非宏来更好隔离</p>\n<p>  <a href=\"https://askubuntu.com/questions/355565/how-do-i-install-the-latest-version-of-cmake-from-the-command-line\">ubuntu 安装最新 cmake</a></p>\n</li>\n</ul>\n<h1 id=\"2-介绍\"><a href=\"#2-介绍\" class=\"headerlink\" title=\"2 介绍\"></a>2 介绍</h1><ul>\n<li>编译、链接、库 等原理</li>\n<li>三要素，目标、依赖、命令，依赖比目标或目标不存在新就执行命令。找到关系树的末端再从末端进行判断，末端比根旧则什么都不做，新则执行命令。</li>\n<li>不要用环境变量 MAKEFILES</li>\n<li>Makefile 的组成<ul>\n<li>显示规则，我们写的</li>\n<li>隐含规则，.o 自动生成 .c 依赖的关系 和 编译命令</li>\n<li>变量定义</li>\n<li>文件指示<ul>\n<li><code>include &lt;filename&gt;</code></li>\n<li><code>#if</code></li>\n<li>多行命令</li>\n</ul>\n</li>\n<li>注释，# 转义</li>\n</ul>\n</li>\n</ul>\n<h1 id=\"3-规则\"><a href=\"#3-规则\" class=\"headerlink\" title=\"3 规则\"></a>3 规则</h1><ul>\n<li><p>规则中可以用通配符</p>\n</li>\n<li><p>变量中的通配符不会展开，除非</p>\n  <figure class=\"highlight makefile\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 文件夹下所有的 .c</span></span><br><span class=\"line\">objects := <span class=\"variable\">$(<span class=\"built_in\">wildcard</span> *.c)</span></span><br><span class=\"line\"><span class=\"comment\"># 文件夹下所有的 .o</span></span><br><span class=\"line\">objects := <span class=\"variable\">$(<span class=\"built_in\">patsubst</span> %.c,%.o,$(<span class=\"built_in\">wildcard</span> *.c)</span>)</span><br></pre></td></tr></table></figure></li>\n<li><p>用 vpath 指定多个搜索目录</p>\n</li>\n<li><p>伪目标两个作用 1. clean 2. 一次生成多个目标</p>\n</li>\n<li><p>静态模式与多目标 %，具体看参考</p>\n</li>\n<li><p>依赖的头文件自动生成的方法，具体看参考</p>\n</li>\n</ul>\n<h1 id=\"4-命令\"><a href=\"#4-命令\" class=\"headerlink\" title=\"4 命令\"></a>4 命令</h1><ul>\n<li>@ 可以不显示这条命令</li>\n<li>语句前加 - 可以忽略错误继续执行</li>\n<li>嵌套执行 makefile<ul>\n<li>$(MAKE) -C subdir</li>\n<li>export variable &#x3D; value  或者 unexport 或者 export 导出所有变量到下级</li>\n<li>MAKEFLAGS 和 SHELL 永远被传递给下级，除非见参考文档</li>\n</ul>\n</li>\n<li>常用命令可以定义成命令包</li>\n</ul>\n<h1 id=\"5-变量\"><a href=\"#5-变量\" class=\"headerlink\" title=\"5 变量\"></a>5 变量</h1><p>建议小写作为变量名，大写作为控制隐含规则和用户重载命令选项时使用</p>\n<ul>\n<li><p>递归展开，无法追加 VAR&#x3D;var</p>\n</li>\n<li><p>简单展开 VAR:&#x3D;var</p>\n</li>\n<li><p>?&#x3D; 被定义过什么都不做，没定义则赋值</p>\n<p>  变量使用 $(VAR)</p>\n</li>\n<li><p>预定义变量，比如 CC、RM、CFLAGS</p>\n</li>\n<li><p>自动变量，比如 $@、$&lt;、$^</p>\n</li>\n<li><p>make 启动时自动创建与系统相同数值的环境变量</p>\n</li>\n</ul>\n<h1 id=\"6-make\"><a href=\"#6-make\" class=\"headerlink\" title=\"6 make\"></a>6 make</h1><p>有一些 GNU 约定好的目标表示名称，可以作为写 makefile 的参考，比如 <code>install</code></p>\n<p>用来调试 makefile</p>\n<table>\n<thead>\n<tr>\n<th>参数</th>\n<th>作用</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>-n</td>\n<td>dry run</td>\n</tr>\n<tr>\n<td>-t</td>\n<td>只更新(touch)目标的时间，假装编译</td>\n</tr>\n<tr>\n<td>-q</td>\n<td>看看某个目标在 makefile 中存在吗</td>\n</tr>\n<tr>\n<td>–debug</td>\n<td>打印调试</td>\n</tr>\n<tr>\n<td>-w</td>\n<td>打印目录，用来调试嵌套 make 调用</td>\n</tr>\n</tbody></table>\n<p>其它参数见 man 或者 上面的参考文档</p>\n<h1 id=\"7-隐含规则\"><a href=\"#7-隐含规则\" class=\"headerlink\" title=\"7 隐含规则\"></a>7 隐含规则</h1><ul>\n<li>C程序隐含规则，$(CC) –c $(CPPFLAGS) $(CFLAGS)，其它程序规则见参考文档</li>\n<li>隐含规则使用的变量，如 CC、CFLAGS 具体见文档</li>\n<li>模式规则 %，与自动化变量。if 判断中不能使用自动化变量</li>\n</ul>\n<p><a href=\"https://github.com/2-3-5-7/2-3-5-7.github.io/tree/main/虚拟环境/3. 处理工具/编译工具\"><i class=\"fa-solid fa-download fa-2xl\" style=\"color: gray;\"></i></a></p>\n",
            "tags": []
        },
        {
            "id": "https://synrst.de/%E8%99%9A%E6%8B%9F%E7%8E%AF%E5%A2%83/3.%20%E5%A4%84%E7%90%86%E5%B7%A5%E5%85%B7/%E8%AF%8D%E5%85%B8%E8%BD%AF%E4%BB%B6/",
            "url": "https://synrst.de/%E8%99%9A%E6%8B%9F%E7%8E%AF%E5%A2%83/3.%20%E5%A4%84%E7%90%86%E5%B7%A5%E5%85%B7/%E8%AF%8D%E5%85%B8%E8%BD%AF%E4%BB%B6/",
            "title": "词典软件",
            "date_published": "1970-01-01T00:00:00.000Z",
            "content_html": "<h1 id=\"1-GoldenDict\"><a href=\"#1-GoldenDict\" class=\"headerlink\" title=\"1 GoldenDict\"></a>1 GoldenDict</h1><ul>\n<li>需要 linux 版翻译时使用 GoldenDict</li>\n<li>参考 <a href=\"https://github.com/Dictionaryphile/GoldenDict_zh_manual\">github GoldenDict 手册</a> 下载64bit QT5 压缩版本</li>\n<li>新建 portable 变成便携版，生成的 index 子文件中为词典索引</li>\n<li>将指向 Dictionary 文件夹的快捷方式放入 content，除了欧路专用格式，其它与欧路共用。调整词典顺序</li>\n<li>虽然可以添加欧路和有道在线词典，但查词会变慢，因此不添加且将维基百科也禁用</li>\n<li>新建配置文件调整字体和大小，调整搜索框大小，选择显示哪些面板，关闭不可用的屏幕取词相关功能</li>\n<li>修改设置如下，关闭“双击翻译”，查询结果中继续取词通过弹窗的方式，不使用跳转。基本不使用多标签功能。风格调整为白色背景。<br><img src=\"/%E8%99%9A%E6%8B%9F%E7%8E%AF%E5%A2%83/3.%20%E5%A4%84%E7%90%86%E5%B7%A5%E5%85%B7/%E8%AF%8D%E5%85%B8%E8%BD%AF%E4%BB%B6/../%E8%AF%8D%E5%85%B8%E8%BD%AF%E4%BB%B6/1.png\" alt=\"词典设置\"></li>\n<li>设置 AHK 脚本自启动实现双击查词</li>\n<li>阅读帮助文档中的快捷键实现高效查词</li>\n</ul>\n<h1 id=\"2-欧路词典\"><a href=\"#2-欧路词典\" class=\"headerlink\" title=\"2 欧路词典\"></a>2 欧路词典</h1><ul>\n<li>有生词多终端同步需求时，购买欧路。同时也可用来背单词，配合 kindlemate 背生词 <a href=\"https://zhuanlan.zhihu.com/p/85959508\">欧路词典应用指南</a></li>\n<li>设置字体最大，去掉“取词只显示第一本词典”选项，取词窗口选择固定高度，勾选“划词后直接显示翻译窗口”，去掉每日推荐</li>\n<li>使用划词，快捷键 Alt+F2，Ctrl+Shitft+C 划词快捷键。使用双击方式取词，快捷键 Alt+F3</li>\n<li>取词后自动发音，词典库 -&gt; 发音库将美音置顶</li>\n<li>词典配置从软件的 <code>欧路词典与配置</code> 文件夹导入</li>\n<li>手机版通过 软件设置-&gt; 扩充词库路径，将词典拷贝到该文件夹，默认是 &#x2F;eudb_en</li>\n<li>同步问题通过注销账户重新登陆解决</li>\n</ul>\n<h1 id=\"3-词典\"><a href=\"#3-词典\" class=\"headerlink\" title=\"3 词典\"></a>3 词典</h1><h2 id=\"3-1-选择\"><a href=\"#3-1-选择\" class=\"headerlink\" title=\"3.1 选择\"></a>3.1 选择</h2><ul>\n<li><a href=\"https://zhuanlan.zhihu.com/p/64925212\">欧路词典打磨指南</a> 先柯林斯，然后朗文。一共推荐 5 本字典</li>\n<li><a href=\"https://zhuanlan.zhihu.com/p/20214473\">知乎常用词典介绍</a>，给出的词典很乱，而且介绍的词典与电子版有差距，电子版的质量可能很差</li>\n<li><a href=\"https://www.runningcheese.com/dictionary\">ESL词典比较和下载</a>，比较了 6 种 ESL 词典，并给出朗文和其它专用词典的下载，从电子版质量来看确实朗文收录的最多最好，其次是 科林斯、牛津，像麦克米伦、韦氏、剑桥的电子版排版和词条数都弱，不使用</li>\n</ul>\n<h2 id=\"3-2-获取\"><a href=\"#3-2-获取\" class=\"headerlink\" title=\"3.2 获取\"></a>3.2 获取</h2><ul>\n<li><a href=\"https://pdawiki.com/forum/\">词典论坛</a>，用户名是 <code>e****s</code>，里面的词典需要权限才能下，有名的词典可以通过网上搜索标题的方式获取</li>\n<li><a href=\"https://github.com/skywind3000/ECDICT/wiki/%E7%AE%80%E6%98%8E%E8%8B%B1%E6%B1%89%E5%AD%97%E5%85%B8%E5%A2%9E%E5%BC%BA%E7%89%88\">340万的简明词典</a>，带词频提示，朗文才 23 万，这个词典简洁且全，故显示排在第一位</li>\n</ul>\n<h2 id=\"3-3-词典列表\"><a href=\"#3-3-词典列表\" class=\"headerlink\" title=\"3.3 词典列表\"></a>3.3 词典列表</h2><ul>\n<li>双击 mdx 文件，欧路词典可以在导入前查看词典信息，词条数，但词典信息可能没有词条数</li>\n<li>GoldenDict 建立索引后可以看到准确的词条数</li>\n</ul>\n<table>\n<thead>\n<tr>\n<th>欧路和 GoldenDict 共用词典</th>\n<th>描述</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>简明英汉增强版-去音标</td>\n<td>欧路格式版无法用，用 mdx 格式的。GoldenDict 可以用候选的有音标 CSS 版</td>\n</tr>\n<tr>\n<td>新东方词根联想记忆_考研+托福+gre</td>\n<td></td>\n</tr>\n<tr>\n<td>LDOCE 5++ V2.15</td>\n<td>朗文，ESL，非母语者</td>\n</tr>\n<tr>\n<td>Vocabulary.com 20170103</td>\n<td>通俗解释和例句。这个版本不会卡死</td>\n</tr>\n<tr>\n<td>OELDV1.51</td>\n<td>母语词典</td>\n</tr>\n<tr>\n<td>Oxford Collocations Dictionary for students of English</td>\n<td>搭配词典</td>\n</tr>\n<tr>\n<td>Computer &amp; Network Dicts</td>\n<td>计算机专用分组 5 本词典，已删排版和词条过少的词典<br />WhatIsTechTarget 欧路加载不了</td>\n</tr>\n<tr>\n<td>新汉英大辞典</td>\n<td>汉英</td>\n</tr>\n<tr>\n<td></td>\n<td><strong>—– 下面是候选词典 —–</strong></td>\n</tr>\n<tr>\n<td>简明英汉增强版-CSS</td>\n<td>适合 GoldenDict 美化有音标，但欧路用原生格式更快，且不需要音标</td>\n</tr>\n<tr>\n<td>LDOCE 5++ V1.35</td>\n<td>旧版朗文，在欧路上有空白问题，但色彩比新版丰富些，词条数少了 5万</td>\n</tr>\n<tr>\n<td>CollinsV2.30</td>\n<td>英英解释较易懂，适合初学者，ESL</td>\n</tr>\n<tr>\n<td>OALECD，牛津高阶英汉双解词典(第8版)</td>\n<td>双解，ESL</td>\n</tr>\n<tr>\n<td>COCA词频 60000</td>\n<td>简明增强词典已包含 COCA</td>\n</tr>\n<tr>\n<td>优词词根 18667</td>\n<td>较简洁，从背单词角度仅次于 新东方考研、托福、gre词汇词根及联想记忆，但仍有一些词源介绍</td>\n</tr>\n<tr>\n<td>Vocabulary.com 20180417</td>\n<td>导致欧路和GoldenDict 偶尔卡死</td>\n</tr>\n<tr>\n<td>欧路-英语词根词源 词典</td>\n<td>英语来源部分目前不需要，只是为了辅助记忆。较专业<br />mdx 版词典可以在 pdawiki 找到</td>\n</tr>\n</tbody></table>\n<table>\n<thead>\n<tr>\n<th>欧路专有词典</th>\n<th>描述</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>常用例句库</td>\n<td>与 Vocabulary.com 配合，比原生例句准确些</td>\n</tr>\n<tr>\n<td>听力原声例句</td>\n<td>与 Vocabulary.com 配合</td>\n</tr>\n<tr>\n<td>词组 | 习惯用语</td>\n<td>与 Oxford Collocations Dictionary for students of English 配合</td>\n</tr>\n<tr>\n<td>有道在线词典</td>\n<td>最后手段</td>\n</tr>\n<tr>\n<td>在线词典参考</td>\n<td>在线权威词典</td>\n</tr>\n<tr>\n<td>全文搜索</td>\n<td></td>\n</tr>\n</tbody></table>\n<p><img src=\"/%E8%99%9A%E6%8B%9F%E7%8E%AF%E5%A2%83/3.%20%E5%A4%84%E7%90%86%E5%B7%A5%E5%85%B7/%E8%AF%8D%E5%85%B8%E8%BD%AF%E4%BB%B6/../%E8%AF%8D%E5%85%B8%E8%BD%AF%E4%BB%B6/2.png\" alt=\"欧路词典\"></p>\n<p><a href=\"https://github.com/2-3-5-7/2-3-5-7.github.io/tree/main/虚拟环境/3. 处理工具/词典软件\"><i class=\"fa-solid fa-download fa-2xl\" style=\"color: gray;\"></i></a></p>\n",
            "tags": []
        }
    ]
}