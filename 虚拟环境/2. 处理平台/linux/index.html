<!doctype html>
<html lang="zh"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta keywords="编程, 环境搭建, 读书笔记, Galgame, 生活技巧"><title>linux - 自强不息 厚德载物</title><link rel="manifest" href="/manifest.json"><meta name="application-name" content="自强不息 厚德载物"><meta name="msapplication-TileImage" content="/img/favicon.png"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-title" content="自强不息 厚德载物"><meta name="apple-mobile-web-app-status-bar-style" content="default"><meta name="description" content="123# 通过 aptitude 尝试解决sudo apt install aptitudesudo aptitude install PACKAGENAME1 配置  - 必装 ssh proxychains4 git meld p4merge vim gtags ctags，github 导入公钥 - 关闭该死的系统更新，非要更新前一定创建快照   1.1 SSH  apt-get insta"><meta property="og:type" content="blog"><meta property="og:title" content="linux"><meta property="og:url" content="https://synrst.de/%E8%99%9A%E6%8B%9F%E7%8E%AF%E5%A2%83/2.%20%E5%A4%84%E7%90%86%E5%B9%B3%E5%8F%B0/linux/"><meta property="og:site_name" content="自强不息 厚德载物"><meta property="og:description" content="123# 通过 aptitude 尝试解决sudo apt install aptitudesudo aptitude install PACKAGENAME1 配置  - 必装 ssh proxychains4 git meld p4merge vim gtags ctags，github 导入公钥 - 关闭该死的系统更新，非要更新前一定创建快照   1.1 SSH  apt-get insta"><meta property="og:locale" content="zh_CN"><meta property="og:image" content="https://synrst.de/%E8%99%9A%E6%8B%9F%E7%8E%AF%E5%A2%83/2.%20%E5%A4%84%E7%90%86%E5%B9%B3%E5%8F%B0/linux/mbr_boot_sector.gif"><meta property="og:image" content="https://synrst.de/%E8%99%9A%E6%8B%9F%E7%8E%AF%E5%A2%83/2.%20%E5%A4%84%E7%90%86%E5%B9%B3%E5%8F%B0/linux/loader_menu.gif"><meta property="article:published_time" content="1970-01-01T00:00:00.000Z"><meta property="article:modified_time" content="2023-05-28T09:27:51.603Z"><meta property="article:author" content="2-3-5-7"><meta property="twitter:card" content="summary"><meta property="twitter:image:src" content="https://synrst.de/%E8%99%9A%E6%8B%9F%E7%8E%AF%E5%A2%83/2.%20%E5%A4%84%E7%90%86%E5%B9%B3%E5%8F%B0/linux/mbr_boot_sector.gif"><script type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"https://synrst.de/%E8%99%9A%E6%8B%9F%E7%8E%AF%E5%A2%83/2.%20%E5%A4%84%E7%90%86%E5%B9%B3%E5%8F%B0/linux/"},"headline":"linux","image":["https://synrst.de/%E8%99%9A%E6%8B%9F%E7%8E%AF%E5%A2%83/2.%20%E5%A4%84%E7%90%86%E5%B9%B3%E5%8F%B0/linux/mbr_boot_sector.gif","https://synrst.de/%E8%99%9A%E6%8B%9F%E7%8E%AF%E5%A2%83/2.%20%E5%A4%84%E7%90%86%E5%B9%B3%E5%8F%B0/linux/loader_menu.gif"],"datePublished":"1970-01-01T00:00:00.000Z","dateModified":"2023-05-28T09:27:51.603Z","author":{"@type":"Person","name":"2-3-5-7"},"publisher":{"@type":"Organization","name":"自强不息 厚德载物","logo":{"@type":"ImageObject","url":"https://synrst.de/img/logo.svg"}},"description":"123# 通过 aptitude 尝试解决sudo apt install aptitudesudo aptitude install PACKAGENAME1 配置  - 必装 ssh proxychains4 git meld p4merge vim gtags ctags，github 导入公钥 - 关闭该死的系统更新，非要更新前一定创建快照   1.1 SSH  apt-get insta"}</script><link rel="canonical" href="https://synrst.de/%E8%99%9A%E6%8B%9F%E7%8E%AF%E5%A2%83/2.%20%E5%A4%84%E7%90%86%E5%B9%B3%E5%8F%B0/linux/"><link rel="icon" href="/img/favicon.png"><link rel="stylesheet" href="https://use.fontawesome.com/releases/v6.0.0/css/all.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@9.12.0/styles/atom-one-light.css"><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Ubuntu:wght@400;600&amp;family=Source+Code+Pro"><link rel="stylesheet" href="/css/default.css"><!--!--><!--!--><!--!--><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/lightgallery@1.10.0/dist/css/lightgallery.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/justifiedGallery@3.8.1/dist/css/justifiedGallery.min.css"><script src="https://www.googletagmanager.com/gtag/js?id=G-RMG9YTVY9M" async></script><script>window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
    
        gtag('config', 'G-RMG9YTVY9M');</script><!--!--><!--!--><!--!--><!-- hexo injector head_end start --><script>
  (function () {
      function switchTab() {
          if (!location.hash) {
            return;
          }

          const id = '#' + CSS.escape(location.hash.substring(1));
          const $tabMenu = document.querySelector(`.tabs a[href="${id}"]`);
          if (!$tabMenu) {
            return;
          }

          const $tabMenuContainer = $tabMenu.parentElement.parentElement;
          Array.from($tabMenuContainer.children).forEach($menu => $menu.classList.remove('is-active'));
          Array.from($tabMenuContainer.querySelectorAll('a'))
              .map($menu => document.getElementById($menu.getAttribute("href").substring(1)))
              .forEach($content => $content.classList.add('is-hidden'));

          if ($tabMenu) {
              $tabMenu.parentElement.classList.add('is-active');
          }
          const $activeTab = document.querySelector(id);
          if ($activeTab) {
              $activeTab.classList.remove('is-hidden');
          }
      }
      switchTab();
      window.addEventListener('hashchange', switchTab, false);
  })();
  </script><!-- hexo injector head_end end --><meta name="generator" content="Hexo 6.3.0"></head><body class="is-2-column"><nav class="navbar navbar-main"><div class="container navbar-container"><div class="navbar-brand justify-content-center"><a class="navbar-item navbar-logo" href="/"><i class="fa-regular fa-face-grin-squint-tears"></i></a><div class="navbar-item">Mens et Manus</div><a class="navbar-item search" title="搜索 (Ctrl + K)" href="javascript:;"><i class="fas fa-search"></i></a></div></div></nav><section class="section"><div class="container"><div class="columns"><div class="column order-2 column-main is-8-tablet is-8-desktop is-8-widescreen"><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><a class="link-muted" href="/categories/%E8%99%9A%E6%8B%9F%E7%8E%AF%E5%A2%83/">虚拟环境</a><span> / </span><a class="link-muted" href="/categories/%E8%99%9A%E6%8B%9F%E7%8E%AF%E5%A2%83/2-%E5%A4%84%E7%90%86%E5%B9%B3%E5%8F%B0/">2. 处理平台</a></span></div></div><h1 class="title is-3 is-size-4-mobile">linux</h1><div class="content"><h1 id="1-配置"><a href="#1-配置" class="headerlink" title="1 配置"></a>1 配置</h1><ul>
<li>必装 ssh proxychains4 git meld p4merge vim gtags ctags，github 导入公钥</li>
<li>关闭该死的系统更新，非要更新前一定创建快照</li>
</ul>
<h2 id="1-1-SSH"><a href="#1-1-SSH" class="headerlink" title="1.1 SSH"></a>1.1 SSH</h2><p><code>apt-get install openssh-server openssh-client</code></p>
<ul>
<li>如配置 VPS 修改 SSH 端口，则要在系统 iptables 和 vps 页面两处同时放行新端口，并用 nc -l 测试没问题后，再重启 sshd 服务。此时先别断开旧连接，防止出现新端口连不上的情况</li>
</ul>
<h3 id="1-1-1-解决-20-04-broken-package-问题"><a href="#1-1-1-解决-20-04-broken-package-问题" class="headerlink" title="1.1.1 解决 20.04 broken package 问题"></a>1.1.1 解决 20.04 broken package 问题</h3><p>参考 <a target="_blank" rel="noopener" href="https://ubuntuforums.org/showthread.php?t=2412211">Problems with installing of the openssh-server</a></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 通过 aptitude 尝试解决</span></span><br><span class="line">sudo apt install aptitude</span><br><span class="line">sudo aptitude install PACKAGENAME</span><br></pre></td></tr></table></figure>
<p>根据  aptitude 安装前的提示，发现是预安装的 openssh-client 版本高，apt purge openssl-client 卸载后安装 openssh-server 没问题。<br>也可以降级已安装的包，<code>sudo apt install &lt;package-name&gt;=&lt;package-version-number&gt;</code></p>
<h3 id="1-1-2-secureCRT-配置问题"><a href="#1-1-2-secureCRT-配置问题" class="headerlink" title="1.1.2 secureCRT 配置问题"></a>1.1.2 secureCRT 配置问题</h3><ol>
<li>关闭不用的菜单栏、状态栏等，去掉 use dockable session manager 选项，记住连接管理的快捷键即可</li>
<li>编码与字体<br> 在Options -&gt; Session Options -&gt; Appearance 选项中将 Character encoding 设成”UTF-8”即可，字体 Consolas-with-Yahei，三号。没办法用没有 CJK 字符的字体</li>
<li>启用颜色<br> 官方的介绍 <a target="_blank" rel="noopener" href="https://www.youtube.com/watch?v=SZLbBsp3914">https://www.youtube.com/watch?v=SZLbBsp3914</a><br> 在 default session 中选 solarized dark，emulation 中启用 xterm-256color<br> 在全局配置中外观 - 高级，选中 solarized dark 新建一个颜色模式<br> 将 normal 和 bold 中前景色调亮，同时下拉列表选择 solarized dark，在 default session 中应用<br> 前景色 RGB 颜色 166,177,179<br> 详细参考视频 <a target="_blank" rel="noopener" href="http://www.youtube.com/watch?v=SZLbBsp3914">www.youtube.com/watch?v=SZLbBsp3914</a></li>
<li>调整系统提示声音，将 默认响声 设置为 windows信息栏.wav</li>
<li>安装 Xming，对于 ubuntu 的 session 中勾选 X11 forwarding 两个选项，默认配置即可</li>
<li><ul>
<li>Options–&gt;Session Options–&gt;Terminal 启用选择发送滚轮事件到远程。取消 Scroll to bottom on output<ul>
<li>Options–&gt;Session Options–&gt;Terminal–&gt;Emulation–&gt;Mapped Keys，选中 Backspace sends delete<br>  默认会话中终端</li>
<li>Options–&gt;Session Options–&gt;Terminal–&gt;Emulation–&gt;Mode，取消 Enable keypad mode switching 小键盘映射</li>
<li>Options–&gt;Session Options–&gt;Terminal–&gt;Emulation–&gt;Advanced，忽略窗口标题更改请求</li>
<li>Options–&gt;Edit Default Session 设置常用的按键映射，运行脚本 a-r、取消脚本 a-s、清屏 a-l (clear)、滚动到底部 a-b</li>
<li>（可选）<a target="_blank" rel="noopener" href="https://forums.vandyke.com/showthread.php?p=42242">添加键盘映射</a>，HOME&#x2F;END 为 <code>\033[H</code> 和 <code>\033[F</code>，原理见下 Terminal input sequences</li>
</ul>
</li>
</ul>
</li>
</ol>
<h3 id="1-1-3-隧道-端口转发"><a href="#1-1-3-隧道-端口转发" class="headerlink" title="1.1.3 隧道/端口转发"></a>1.1.3 隧道/端口转发</h3><ul>
<li>代理就是通过隧道帮助用户要访问某个受限资源</li>
<li>隧道由本地和远端组成，本地作为 SSH 客户端连接远端 SSH 服务器端</li>
</ul>
<pre class="mermaid">graph LR
    subgraph 代理
    用户 -- 隧道 --> 受限资源
    end
    subgraph 隧道
    L("本地 local，客户端") --> R("远端 remote，服务器")
    end</pre>

<ul>
<li>按情况分为用户在隧道的本地和远端两种，常见三种 <a target="_blank" rel="noopener" href="https://wangdoc.com/ssh/port-forwarding.html">转发方式</a></li>
<li>所谓用户就是要连接监听端口的设备<ul>
<li>所以对用户在本地 local 的，使用 -D 或 -L 打开本地端口，转发给 remote 侧的某资源。如资源为固定的 ip port 用 -L，动态的多个资源用 -D<ul>
<li>这种场景如科学上网，-D 打开本地的 sock5 监听端口，加密连到 vps，动态访问各个网站</li>
</ul>
</li>
<li>对用户在远端 remote 的，用 -R 打开远端端口。同样可固定可动态，填 ip port 是固定，不填为动态<ul>
<li>这种场景如内网穿透，内网必须作为客户端主动连公网服务器端<ul>
<li>为了防止连接中断可 <a target="_blank" rel="noopener" href="https://cloud.tencent.com/developer/article/1722055">写个脚本</a></li>
<li>但在公网服务器开端口暴露内网资源可能不安全（有的内网资源没有密码等），真要这样用还需配置 <code>GatewayPorts yes</code>，否则只会在环回口监听</li>
<li>所以为了安全，即 1. 要有授权的客户端才能连服务端口 2. 保证用户到服务端口之间数据的安全性（socks 协议不加密）。在先用 -R 开启环回口（动态方式）后，再在用户侧用 -L 练到公网服务器，见 <a target="_blank" rel="noopener" href="https://o-u-u.com/?p=3234#%E9%93%BE%E5%BC%8F%E7%AB%AF%E5%8F%A3%E8%BD%AC%E5%8F%91">链式端口转发</a> (文中为固定转发给 3000 端口，可改为动态)</li>
</ul>
</li>
</ul>
</li>
<li>图中的 4 个角色（资源、用户、local、remote）可重合，即特殊情况<ul>
<li>local 和 remote 为同一台设备，如将这台设备用作 socks 代理服务器 <code>ssh -D port localhost</code></li>
<li>用户与 local &#x2F; remote 为同一设备，资源与 local &#x2F; remote 为同一设备的情况</li>
</ul>
</li>
<li>如要只将 ssh 用作隧道，限制用户登陆，可以 <a target="_blank" rel="noopener" href="https://unix.stackexchange.com/questions/14312/how-to-restrict-an-ssh-user-to-only-allow-ssh-tunneling">修改用户的 shell</a></li>
<li>对 windows 可用配置好连接信息的绿色版 putty 来当作 vpn 客户端的功能</li>
</ul>
</li>
</ul>
<pre class="mermaid">graph LR
    subgraph 用户在本地一侧 -L/-D
    s1(用户) --> s2(local) --> s3(remote) --> s4(受限资源)
    end
    subgraph 用户在远端一侧 -R
    s5(受限资源) --> s6(local) --> s7(remote) --> s8(用户)
    end
    subgraph 特殊情况
    s9("local 与 remote 重合，ssh -D port localhost")
    s10("用户/受限资源 与 local/remote 重合")
    end
    subgraph 内网穿透
    s11(受限资源) --> s12(local) -- -R动态方式 --> s13(remote) -- -L连接到-R的动态端口 --> s14(用户)
    end</pre>

<h3 id="1-1-4-DNS-介绍"><a href="#1-1-4-DNS-介绍" class="headerlink" title="1.1.4 DNS 介绍"></a>1.1.4 DNS 介绍</h3><ul>
<li><a target="_blank" rel="noopener" href="https://lantian.pub/article/modify-website/selfhost-dns-root-server.lantian/">DNS 原理和自建 DNS 根服务器</a>、<a target="_blank" rel="noopener" href="https://juejin.cn/post/6844903497494855687">另一个参考</a></li>
</ul>
<h2 id="1-2-系统"><a href="#1-2-系统" class="headerlink" title="1.2 系统"></a>1.2 系统</h2><ol>
<li><p>设置 PS1 <code>export PS1=&quot;\[\e[35;22m\][\! \A \w] \[\e[0m\]&quot;</code>，如要改变标题则继续加一句，<code>PS1=&quot;\[\e]0;20.04: \W\a\]$PS1&quot;</code> ，把 20.04 改成想要的名字</p>
</li>
<li><p>ls 颜色 <a target="_blank" rel="noopener" href="https://github.com/seebi/dircolors-solarized">https://github.com/seebi/dircolors-solarized</a><br>  .bashrc 中添加 eval <code>dircolors ~/dircolors-solarized/dircolors.256dark</code></p>
</li>
<li><p>给 man 命令启用颜色，~&#x2F;.bashrc 添加如下</p>
  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="title">man</span></span>() &#123;</span><br><span class="line"> <span class="built_in">env</span> \</span><br><span class="line"> LESS_TERMCAP_mb=$(<span class="built_in">printf</span> <span class="string">&quot;\e[1;31m&quot;</span>) \</span><br><span class="line"> LESS_TERMCAP_md=$(<span class="built_in">printf</span> <span class="string">&quot;\e[1;31m&quot;</span>) \</span><br><span class="line"> LESS_TERMCAP_me=$(<span class="built_in">printf</span> <span class="string">&quot;\e[0m&quot;</span>) \</span><br><span class="line"> LESS_TERMCAP_se=$(<span class="built_in">printf</span> <span class="string">&quot;\e[0m&quot;</span>) \</span><br><span class="line"> LESS_TERMCAP_so=$(<span class="built_in">printf</span> <span class="string">&quot;\e[1;44;33m&quot;</span>) \</span><br><span class="line"> LESS_TERMCAP_ue=$(<span class="built_in">printf</span> <span class="string">&quot;\e[0m&quot;</span>) \</span><br><span class="line"> LESS_TERMCAP_us=$(<span class="built_in">printf</span> <span class="string">&quot;\e[1;32m&quot;</span>) \</span><br><span class="line"> man <span class="string">&quot;<span class="variable">$@</span>&quot;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>修改时区</p>
  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo <span class="built_in">unlink</span> /etc/localtime</span><br><span class="line">sudo <span class="built_in">ln</span> -s /usr/share/zoneinfo/Asia/Shanghai /etc/localtime</span><br></pre></td></tr></table></figure></li>
</ol>
<h3 id="1-2-1-Kali"><a href="#1-2-1-Kali" class="headerlink" title="1.2.1 Kali"></a>1.2.1 Kali</h3><ul>
<li><a target="_blank" rel="noopener" href="https://www.youtube.com/watch?v=a6z-ixNAo-s">How to move taskbar from top to bottom in kali linux</a>  Settings Editor -&gt; xfce4-panel -&gt; panels&#x2F;panel-1&#x2F;position 的 6 改成 4，下面的 size 可扩大，以让图标更大</li>
</ul>
<h2 id="1-3-网络"><a href="#1-3-网络" class="headerlink" title="1.3 网络"></a>1.3 网络</h2><p>思路是用无线网卡使 PC、虚拟机、无线路由器处于同一网络中，可以上网。用有线网卡使 PC、虚拟机、开发板处于另一网络中。</p>
<p>要点，配置网关的网卡将作为上网网卡，旧网卡（无线网卡）用来上网，所以只有旧网卡有网关</p>
<p><a target="_blank" rel="noopener" href="https://linuxize.com/post/how-to-configure-static-ip-address-on-ubuntu-18-04/">18.04_20.04 用 netplan</a>，配置文件示例见 asset，命令 <code>sudo netplan --debug apply</code></p>
<p>interfaces 和 NetworkManger 即配置文件与图形界面两种方法不能同时使用，对于 <code>/etc/network/interfaces</code> 配置文件如下</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">auto eth0</span><br><span class="line">iface eth0 inet static</span><br><span class="line">address 192.168.2.36</span><br><span class="line">netmask 255.255.255.0</span><br><span class="line">gateway 192.168.2.1</span><br><span class="line"></span><br><span class="line">auto eth1</span><br><span class="line">iface eth1 inet static</span><br><span class="line">address 192.168.1.36</span><br><span class="line">netmask 255.255.255.0</span><br><span class="line"></span><br><span class="line"># dhcp方式</span><br><span class="line"># auto eth0  </span><br><span class="line"># iface eth0 inet dhcp</span><br></pre></td></tr></table></figure>

<p><code>/etc/resolvconf/resolv.conf.d/base</code> 配置 dns，没有则新建。<code>sudo resolvconf -u 立即生效</code></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">nameserver 114.114.114.114</span><br><span class="line">nameserver 8.8.8.8</span><br></pre></td></tr></table></figure>

<h2 id="1-4-内部局域网"><a href="#1-4-内部局域网" class="headerlink" title="1.4 内部局域网"></a>1.4 内部局域网</h2><p>为了搭建封闭的局域网，可以在 windows 中 <a target="_blank" rel="noopener" href="https://blog.csdn.net/EDDJH_31/article/details/82694205">添加 KM-TEST 虚拟网卡</a>，所有虚拟机桥接到该网卡，实现虚拟机间和主机与虚拟机的通信</p>
<h3 id="1-4-1-代理"><a href="#1-4-1-代理" class="headerlink" title="1.4.1 代理"></a>1.4.1 代理</h3><p> proxychains4，适用于所有包管理系统和 git</p>
<ol>
<li>SSR 选择允许局域网</li>
<li>apt 安装 proxychains4</li>
<li>配置<ul>
<li>配置文件在 <code>/etc/proxychains.conf</code> 或 <code>proxychains4.conf</code>，改成 <code>socks5  192.168.7.36 17890</code></li>
<li>设置 DNS 文件在 <code>/usr/lib/proxychains3/proxyresolv</code>，修改 <code>DNS_SERVER=8.8.8.8</code></li>
</ul>
</li>
<li>注意配置文件代理地址设置成 host 的 IP 192.168.2.29，不是 127.0.0.1</li>
<li>tsocks 不那么好用，先不考虑</li>
</ol>
<h3 id="1-4-2-软件源"><a href="#1-4-2-软件源" class="headerlink" title="1.4.2 软件源"></a>1.4.2 软件源</h3><p><a target="_blank" rel="noopener" href="https://blog.csdn.net/xiangxianghehe/article/details/80112149">中科大</a></p>
<h2 id="1-5-sshfs-win"><a href="#1-5-sshfs-win" class="headerlink" title="1.5 sshfs-win"></a>1.5 sshfs-win</h2><ul>
<li>先装 winfsp (Cryptomator 也装了 winfsp)，然后装 <a target="_blank" rel="noopener" href="https://github.com/billziss-gh/sshfs-win">sshfs</a> 64位</li>
<li>计算机上右键 <code>映射网络驱动器</code>，不要选 <code>添加网络位置</code>，勾选 <code>登陆重连</code></li>
<li>mount home 的情况，<code>\\sshfs\compilers@192.168.36.3</code></li>
<li>mount 其它目录的情况，<code>\\sshfs.r\compilers@192.168.36.3\usr\class\cs143\cool</code></li>
<li>使用 key 和代理的情况<ul>
<li>配置文件 C:\Users\用户.ssh\config</li>
<li>IdentityFile 指定私钥路径</li>
<li>ProxyCommand 指定代理，这里用 <a target="_blank" rel="noopener" href="https://nmap.org/download.html">nmap 附带的 ncat</a><ul>
<li><code>ProxyCommand D:/soft/Nmap/ncat.exe --proxy 127.0.0.1:17890 --proxy-type socks5 %h %p</code></li>
<li><a target="_blank" rel="noopener" href="https://superuser.com/questions/714845/tunneling-ssh-via-a-socks5-proxy-on-windows">参考</a></li>
</ul>
</li>
<li>打开 cmd （非管理员权限），<code>sshfs-win.exe svc \sshfs.k\ubuntu@主机!端口 v: -d -o LogLevel=DEBUG3</code><ul>
<li>映射为 v:</li>
<li>调试信息 -d -o LogLevel&#x3D;DEBUG3</li>
</ul>
</li>
<li>但因为 ProxyCommand 依赖 sh，参考 <a target="_blank" rel="noopener" href="https://github.com/winfsp/sshfs-win/issues/152">这里</a> 的方法，下载 busybox 并改名为 sh.exe，可避免装 Cygwin。同时 ProxyCommand 也要改成能识别的斜杠 &#x2F;</li>
<li>如直接映射驱动器 \sshfs.k\ubuntu@IP!端口（而非 sshfs-win.exe 命令），则不会使用 config 文件，此时 key 只能放在 C:\Users\用户.ssh 下</li>
</ul>
</li>
</ul>
<h2 id="1-6-samba、tftp、nfs"><a href="#1-6-samba、tftp、nfs" class="headerlink" title="1.6 samba、tftp、nfs"></a>1.6 samba、tftp、nfs</h2><ul>
<li>linux samba 3.6.0 开始支持 SMB2，之前的版本需要在 Windows 控制面板启用 SMB1.0 客户端，用命令 <code>sudo smbstatus</code> 查看软件和协议版本<ul>
<li>即可以在控制面板启用，也可以 powershell 管理员运行 <code>Enable-WindowsOptionalFeature -Online -FeatureName &quot;SMB1Protocol-Client&quot;</code></li>
<li>samba 可能不稳定，重启 Windows 后会无法连接。要重新敲上面的 enable 命令后再重启宿主机和虚拟机才能连上，可把上面命令保存成脚本并 <a target="_blank" rel="noopener" href="https://superuser.com/questions/108207/how-to-run-a-powershell-script-as-administrator">管理员运行</a>方便后续使用</li>
<li>对于 virtualbox 虚拟机导出给 vmvare 使用时，遇到 virtualbox 服务找不到无法启动图形界面时，进命令行卸载 virtualbox 服务，<code>cd /etc/init.d</code> 、<code>sudo ./vboxadd cleanup</code>、<code>sudo ./vboxadd-x11 cleanup</code></li>
<li>samba 不稳定也可考虑用 ssh 映射替代，见 [sshfs-win](## 1.5 sshfs-win)<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 安装</span></span><br><span class="line"><span class="comment"># 20.04 同样出现 broken package 问题，先卸载高版本的依赖 sudo apt purge libwbclient0 samba-libs，再安装</span></span><br><span class="line">apt-get install samba samba-common</span><br><span class="line"><span class="comment"># 备份配置文件</span></span><br><span class="line"><span class="built_in">cp</span> /etc/samba/smb.conf /etc/samba/smb.conf.bak</span><br><span class="line"><span class="comment"># 修改smb.conf。添加一个共享定义，share 表示windows连接到的文件夹名为 \\ip\share</span></span><br><span class="line"><span class="comment"># create mask = 0644 避免添加执行权限</span></span><br><span class="line">[share]</span><br><span class="line">		comment = samba home share</span><br><span class="line">		path = /home/zack</span><br><span class="line">		browseable = <span class="built_in">yes</span></span><br><span class="line">		<span class="built_in">read</span> only = no</span><br><span class="line">		create mask = 0644</span><br><span class="line">		directory mask = 0777</span><br><span class="line"><span class="comment"># 添加用户</span></span><br><span class="line">sudo smbpasswd -a zack</span><br><span class="line"><span class="comment"># 重启服务</span></span><br><span class="line">sudo service smbd restart</span><br></pre></td></tr></table></figure></li>
</ul>
</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#安装</span></span><br><span class="line">apt-get install tftp-hpa tftpd-hpa xinetd</span><br><span class="line"><span class="comment">#设置目录</span></span><br><span class="line">vi /etc/default/tftpd-hpa</span><br><span class="line"><span class="comment">#启动服务</span></span><br><span class="line">service tftpd-hpa restart</span><br><span class="line"></span><br><span class="line"><span class="comment">#测试</span></span><br><span class="line">tftp 127.0.0.1</span><br><span class="line">tftp&gt; get hello</span><br><span class="line">tftp&gt; quit</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 检查nfs服务是否安装。没有则 sudo apt-get install nfs-kernel-server</span></span><br><span class="line">service nfs-kernel-server</span><br><span class="line">tar xvf  rootfs.tar.xz </span><br><span class="line">sudo <span class="built_in">chmod</span> 777 rootfs	  </span><br><span class="line"><span class="comment"># 重启nfs服务(使得前面修改生效)</span></span><br><span class="line">sudo /etc/init.d/nfs-kernel-server restart</span><br><span class="line"></span><br><span class="line"><span class="comment"># 测试nfs服务是否安装成功</span></span><br><span class="line">sudo mount -t nfs localhost:/nfs/rootfs/  /mnt/</span><br><span class="line"><span class="comment"># 如果其中的内容和/nfs/rootfs中一致。 表示有挂载成功</span></span><br><span class="line"><span class="built_in">ls</span> /mnt/</span><br><span class="line">sudo umount /mnt</span><br></pre></td></tr></table></figure>

<h2 id="1-7-ftp"><a href="#1-7-ftp" class="headerlink" title="1.7 ftp"></a>1.7 ftp</h2><p>更多安全相关的配置见 <a target="_blank" rel="noopener" href="https://www.digitalocean.com/community/tutorials/how-to-set-up-vsftpd-for-a-user-s-directory-on-ubuntu-16-04">vsftp 配置</a></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">sudo <span class="built_in">cp</span> /etc/vsftpd.conf /etc/vsftpd.conf.orig</span><br><span class="line"></span><br><span class="line"><span class="comment"># Allow anonymous FTP? (Disabled by default).</span></span><br><span class="line">anonymous_enable=NO</span><br><span class="line"><span class="comment"># Uncomment this to allow local users to log in.</span></span><br><span class="line">local_enable=YES</span><br><span class="line"><span class="comment"># 可上传</span></span><br><span class="line">write_enable=YES</span><br><span class="line"><span class="comment"># 用户列表</span></span><br><span class="line">userlist_enable=YES</span><br><span class="line">userlist_file=/etc/vsftpd.userlist</span><br><span class="line">userlist_deny=NO</span><br><span class="line"><span class="comment"># 在这里添加可登录的用户，系统的用户名和密码</span></span><br><span class="line">/etc/vsftpd.userlist</span><br></pre></td></tr></table></figure>

<h2 id="1-8-编译工具"><a href="#1-8-编译工具" class="headerlink" title="1.8 编译工具"></a>1.8 编译工具</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 20.04 同样有 broken package 问题，要降级安装 libc</span></span><br><span class="line">sudo apt install build-essential python3</span><br><span class="line"><span class="comment"># 安装最新 cmake，参考 https://askubuntu.com/questions/355565/how-do-i-install-the-latest-version-of-cmake-from-the-command-line</span></span><br><span class="line">wget -O - https://apt.kitware.com/keys/kitware-archive-latest.asc 2&gt;/dev/null | gpg --dearmor - | sudo <span class="built_in">tee</span> /etc/apt/trusted.gpg.d/kitware.gpg &gt;/dev/null</span><br><span class="line">sudo apt-add-repository <span class="string">&#x27;deb https://apt.kitware.com/ubuntu/ focal main&#x27;</span>  </span><br><span class="line">sudo apt update</span><br><span class="line">sudo apt install cmake</span><br></pre></td></tr></table></figure>

<h2 id="1-9-chrome"><a href="#1-9-chrome" class="headerlink" title="1.9 chrome"></a>1.9 chrome</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 装 chrome</span></span><br><span class="line">https://dl.google.com/linux/direct/google-chrome-stable_current_x86_64.rpm</span><br><span class="line">yum localinstall google-chrome-stable_current_x86_64.rpm</span><br><span class="line"><span class="comment"># chromedriver，下载 linux64 版本</span></span><br><span class="line">https://chromedriver.chromium.org/downloadsba</span><br></pre></td></tr></table></figure>

<h2 id="1-10-vps"><a href="#1-10-vps" class="headerlink" title="1.10 vps"></a>1.10 vps</h2><ul>
<li><p>改端口号</p>
<ul>
<li>sudo passwd 设置密码，为了以后 VNC 抢救时可以登陆设备</li>
<li>备份防火墙 <code>sudo iptables-save &gt;fire.backup</code></li>
<li>添加 ssh 端口号，<code>iptables -I INPUT 1 -p tcp --dport xxxx -j ACCEPT</code></li>
<li>nc 测试新端口能被连接</li>
<li>修改 <code>sudo vi /etc/ssh/sshd_config</code> 的 Port</li>
<li><code>sudo systemctl restart sshd</code>，先不关闭旧连接，测试新端口是否生效</li>
</ul>
</li>
<li><p>改防火墙</p>
<ul>
<li>事先备份  <code>sudo iptables-save &gt;fire.backup</code></li>
<li>删除无用项，或还原改后配置 <code>sudo iptables-restore fire.now</code></li>
<li>永久保存，避免重启后失效，<code>sudo netfilter-persistent save</code></li>
<li>重启测试 <code>sudo reboot</code></li>
</ul>
</li>
<li><p>修改 PS1 和时区</p>
</li>
<li><p>备份还原</p>
<ul>
<li>对 X86，可创建 5 个备份，需要还原时，先删机，等完全终止后，利用之前的引导卷新建机器</li>
<li>对 ARM，因通常很难创建，使用 dd 备份还原<ol>
<li>停止实例，分离引导卷</li>
<li>附加到另一实例的块存储卷，并用命令（iSCSI 命令和信息）连接</li>
<li>sudo fdisk -l 查看为 &#x2F;sdb 硬盘，备份或还原<ul>
<li>备份 <code>sudo nohup bash -c &quot;dd if=/dev/sdb conv=sync,noerror bs=64M status=progress | gzip -c &gt;backup.gz&quot; &amp;</code></li>
<li>还原 <code>sudo nohup bash -c &quot;gunzip -c backup.gz | dd of=/dev/sdb bs=64M status=progress&quot; &amp;</code></li>
<li>查看进度 <code>sudo tail -f nohup.out</code>，ubuntu 20.04 原始备份时间 35min 大小 650M，还原时间相同，dd 的 bs 越大越好</li>
</ul>
</li>
<li>附加引导卷，启动实例</li>
<li>用命令（iSCSI 命令和信息）断开连接，并分离</li>
</ol>
</li>
</ul>
</li>
<li><p>为优化资源占用，多使用 <a target="_blank" rel="noopener" href="https://www.howtogeek.com/668986/how-to-use-the-linux-top-command-and-understand-its-output/">top 命令</a></p>
</li>
<li><p><a target="_blank" rel="noopener" href="https://apttutorials.com/how-to-fix-snapd-process-consuming-lot-of-data-and-cpu/">卸载 snap</a>，防止 CPU 占用高，<code>sudo systemctl stop snapd</code>,  <code>sudo apt purge snapd</code></p>
</li>
<li><p>关闭甲骨文日志 <code>systemctl stop unified-monitoring-agent</code>，<code>systemctl disable unified-monitoring-agent</code></p>
</li>
<li><p>关闭 fwupd <code>sudo systemctl stop fwupd</code>， <code>sudo systemctl disable fwupd</code></p>
</li>
<li><p><a target="_blank" rel="noopener" href="https://askubuntu.com/questions/1233025/how-to-remove-gnome-shell-from-ubuntu-20-04-lts-to-install-other-desktop-environ">卸载 gnome</a>，然后重启</p>
  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">sudo apt update</span><br><span class="line">sudo apt purge adwaita-icon-theme gedit-common gir1.2-gdm-1.0 \</span><br><span class="line">gir1.2-gnomebluetooth-1.0 gir1.2-gnomedesktop-3.0 gir1.2-goa-1.0 \</span><br><span class="line">gnome-accessibility-themes gnome-bluetooth gnome-calculator gnome-calendar \</span><br><span class="line">gnome-characters gnome-control-center gnome-control-center-data \</span><br><span class="line">gnome-control-center-faces gnome-desktop3-data \</span><br><span class="line">gnome-font-viewer \</span><br><span class="line">gnome-initial-setup gnome-keyring gnome-keyring-pkcs11 gnome-logs \</span><br><span class="line">gnome-mahjongg gnome-menus gnome-mines gnome-online-accounts \</span><br><span class="line">gnome-power-manager gnome-screenshot gnome-session-bin gnome-session-canberra \</span><br><span class="line">gnome-session-common gnome-settings-daemon gnome-settings-daemon-common \</span><br><span class="line">gnome-shell gnome-shell-common gnome-shell-extension-appindicator \</span><br><span class="line">gnome-shell-extension-desktop-icons gnome-shell-extension-ubuntu-dock \</span><br><span class="line">gnome-startup-applications gnome-sudoku gnome-system-monitor gnome-terminal \</span><br><span class="line">gnome-terminal-data gnome-themes-extra gnome-themes-extra-data gnome-todo \</span><br><span class="line">gnome-todo-common gnome-user-docs gnome-user-docs-ru gnome-video-effects \</span><br><span class="line">language-pack-gnome-en language-pack-gnome-en-base language-pack-gnome-ru \</span><br><span class="line">language-pack-gnome-ru-base language-selector-gnome libgail18 libgail18 \</span><br><span class="line">libgail-common libgail-common libgnome-autoar-0-0 libgnome-bluetooth13 \</span><br><span class="line">libgnome-desktop-3-19 libgnome-games-support-1-3 libgnome-games-support-common \</span><br><span class="line">libgnomekbd8 libgnomekbd-common libgnome-menu-3-0 libgnome-todo libgoa-1.0-0b \</span><br><span class="line">libgoa-1.0-common libpam-gnome-keyring libsoup-gnome2.4-1 libsoup-gnome2.4-1 \</span><br><span class="line">nautilus-extension-gnome-terminal pinentry-gnome3 yaru-theme-gnome-shell</span><br><span class="line">sudo apt purge gnome-getting-started-docs gnome-getting-started-docs-ru</span><br></pre></td></tr></table></figure></li>
<li><p>acme.sh 申请证书</p>
<ul>
<li>Google domain，<a target="_blank" rel="noopener" href="https://www.reddit.com/r/sysadmin/comments/13dibxb/googleissued_https_certificates_with_acme_dns_api/">参考</a><ul>
<li>Google Ca<ul>
<li><code>acme.sh --set-default-ca --server google</code></li>
<li>页面获得 eab-kid eab-hmac-key</li>
<li><code>acme.sh --register-account</code></li>
</ul>
</li>
<li>letsencrypt CA，<code>acme.sh --set-default-ca --server letsencrypt</code></li>
<li>页面获得 API-Token，export GOOGLEDOMAINS_ACCESS_TOKEN&#x3D;”获得的 token”</li>
<li><code>acme.sh --issue --dns dns_googledomains -d synrst.de -d *.synrst.de -k ec-384</code></li>
<li>安装 <code>acme.sh --install-cert -d synrst.de -d *.synrst.de --ecc --key-file /etc/XXX/server.key --fullchain-file /etc/XXX/server.crt --reloadcmd &quot;systemctl force-reload nginx&quot;</code></li>
</ul>
</li>
<li>其它命令，<a target="_blank" rel="noopener" href="https://github.com/acmesh-official/acme.sh">官方文档</a><ul>
<li>删除证书 <code>acme.sh --remove -d synrst.de -d *.synrst.de</code>，之后按提示删除文件夹（正常还应该 revoke）</li>
<li>强制 renew <code>acme.sh --renew -d synrst.de -d *.synrst.de --force --ecc</code></li>
<li>查看证书 <code>openssl x509 -text -noout -in xxx.cer</code></li>
<li>查看 <code>acme.sh --list</code>，<code>crontab -l</code></li>
</ul>
</li>
</ul>
</li>
<li><p>科学上网加速</p>
<ul>
<li>BBR Plus 加速，<a target="_blank" rel="noopener" href="https://www.youtube.com/watch?v=90xDssO7qIE">区别对比</a></li>
<li>CDN 加速<ul>
<li>v2ray 域名 -&gt; cdn -&gt; vps ip<ul>
<li>在域名上配置<ul>
<li>NS 接入：nameserver 配置成 cloudfare</li>
<li>CNAME&#x2F;IP 接入：v2ray 域名 -&gt; cdn ip&#x2F;域名，域名则添加 CNAME，IP 则添加 A 记录。这是为了配合 DNSPod 不同城市线路用不同的 CDN IP，<a target="_blank" rel="noopener" href="https://www.moeelf.com/archives/10.html">例子</a>，感觉是给机场接入用的，个人 NS 接入即可，<a target="_blank" rel="noopener" href="https://www.youtube.com/watch?v=80rBGZWYlxw">例子</a></li>
</ul>
</li>
<li>在 CDN 配置 ：v2ray 域名 -&gt; vps ip（回源地址）</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<h2 id="1-11-screen"><a href="#1-11-screen" class="headerlink" title="1.11 screen"></a>1.11 screen</h2><p><a id="xa7o"></a></p>
<ul>
<li>.screenrc 文件，参考 <a target="_blank" rel="noopener" href="https://linuxize.com/post/how-to-use-linux-screen/">How To Use Linux Screen</a> 和 <a target="_blank" rel="noopener" href="https://www.gnu.org/software/screen/manual/screen.html">Screen User’s Manual</a>  <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">startup_message off</span><br><span class="line"></span><br><span class="line"># Disable visual bell</span><br><span class="line"># vbell off</span><br><span class="line"></span><br><span class="line"># Set scrollback buffer to 10000</span><br><span class="line">defscrollback 10000</span><br><span class="line"></span><br><span class="line"># https://superuser.com/questions/506080/screen-divider-border-width-and-color</span><br><span class="line">caption string &quot;%&#123;= dd&#125; &quot;</span><br><span class="line">rendition so &quot;=&quot;</span><br><span class="line"># https://stackoverflow.com/questions/359109/using-the-scrollwheel-in-gnu-screen</span><br><span class="line">termcapinfo xterm* ti@:te@</span><br><span class="line"></span><br><span class="line"># 内存部分参考 https://stackoverflow.com/questions/18439129/system-loads-in-gnu-screens-hardstatus-line</span><br><span class="line">hardstatus alwayslastline</span><br><span class="line"># backtick 1 1 1 /bin/bash -c &#x27;free | grep Mem | awk &#x27;\&#x27;&#x27;&#123;printf(&quot;%.1f%%&quot;, $3/$2 * 100.0)&#125;&#x27;\&#x27;&#x27; &#x27;</span><br><span class="line">backtick 1 1 1 /bin/bash -c &#x27;free | grep Mem | awk &#x27;\&#x27;&#x27;&#123;printf(&quot;%.1f%%&quot;, 100 - $7/$2 * 100.0)&#125;&#x27;\&#x27;&#x27; &#x27;</span><br><span class="line">hardstatus string &quot;%&#123;= KG&#125; %-Lw%&#123;= bW&#125;%n%f %t%&#123;-&#125;%+Lw %=%&#123;= Kg&#125;| %c %&#123;-&#125;%l %1`&quot;</span><br><span class="line"># 给 Windows terminal 用的浅色主题 AtomOneLight https://windowsterminalthemes.dev/</span><br><span class="line"># hardstatus string &quot;%&#123;= wG&#125; %-Lw%&#123;= bW&#125;%n%f %t%&#123;-&#125;%+Lw %=%&#123;= wg&#125;| %c %&#123;-&#125;%l %1`&quot;</span><br><span class="line"></span><br><span class="line"># focus ctrl+a tab，other ctrl+a ctrl+a</span><br><span class="line"># 推荐在左侧标签按键，这样右侧标签分到屏幕右侧，按键焦点留在左侧</span><br><span class="line">bind v eval &quot;split -v&quot; focus other focus</span><br><span class="line"># 这个配置焦点在右侧</span><br><span class="line"># bind v eval &quot;split -v&quot; focus other</span><br><span class="line"></span><br><span class="line">bind x remove</span><br></pre></td></tr></table></figure></li>
<li>screen 状态栏显示正在执行的命令或当前路径，<a target="_blank" rel="noopener" href="https://unix.stackexchange.com/questions/28430/screen-status-bar-to-display-current-directory-for-zsh-bash-shell">参考</a><ul>
<li>bash<ul>
<li>.screenrc 文件  <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"># shelltitle | 前面的 ] 表示提示符结尾</span><br><span class="line">shelltitle &#x27;]|bash&#x27;</span><br></pre></td></tr></table></figure></li>
<li>.bashrc 文件  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> [[ <span class="variable">$TERM</span> == screen* ]]; <span class="keyword">then</span></span><br><span class="line">	PROMPT_COMMAND=<span class="string">&#x27;echo -ne &quot;\033k\033\0134\033k[`basename $&#123;PWD&#125;`]\033\0134&quot;&#x27;</span></span><br><span class="line"><span class="keyword">fi</span></span><br></pre></td></tr></table></figure></li>
</ul>
</li>
<li>zsh，<a target="_blank" rel="noopener" href="https://unix.stackexchange.com/questions/28430/screen-status-bar-to-display-current-directory-for-zsh-bash-shell">参考1</a>、<a target="_blank" rel="noopener" href="https://stackoverflow.com/questions/45288905/zsh-mystery-variable-expansion">参考2</a>  <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">setopt extendedglob</span><br><span class="line">if [[ $TERM == screen* ]]; then</span><br><span class="line">	precmd () &#123;</span><br><span class="line">	        local dir=$(print -Pn &quot;%c&quot;)</span><br><span class="line">	        print -Pn &quot;\ek$dir\e\\&quot;</span><br><span class="line">	&#125;</span><br><span class="line">	preexec () &#123;</span><br><span class="line">	        local dir=$(print -Pn &quot;%c&quot;)</span><br><span class="line">	        # 截短是为了留空间显示 CMD</span><br><span class="line">	        dir=$dir[1,6]</span><br><span class="line">	        local CMD=$&#123;1[(wr)^(sudo|*=*|-*)]&#125;</span><br><span class="line">	        print -Pn &quot;\ek$dir] $&#123;CMD&#125;\e\\&quot;</span><br><span class="line">	&#125;</span><br><span class="line">fi</span><br></pre></td></tr></table></figure>
<ul>
<li>相关手册<ul>
<li><a target="_blank" rel="noopener" href="https://zsh.sourceforge.io/Doc/Release/Prompt-Expansion.html#Prompt-Expansion">%c</a></li>
<li><a target="_blank" rel="noopener" href="https://zsh.sourceforge.io/Doc/Release/Expansion.html#Filename-Generation"> ^(<em>&#x3D;</em>|sudo|-*)</a></li>
<li><a target="_blank" rel="noopener" href="https://zsh.sourceforge.io/Doc/Release/Parameters.html">[wr] 的含义 Subscript Flags</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li>常用按键&#x2F;命令</li>
</ul>
<table>
<thead>
<tr>
<th>常用按键&#x2F;命令</th>
<th>含义</th>
</tr>
</thead>
<tbody><tr>
<td>screen</td>
<td>创建<br />启动后 SecureCRT 要调整一下窗口</td>
</tr>
<tr>
<td>screen -ls</td>
<td>查看</td>
</tr>
<tr>
<td>ctrl + a d</td>
<td>detach</td>
</tr>
<tr>
<td>screen -x</td>
<td>Attach to a session which is already attached<br />与 -r 相比推荐这种，可加到 .bashrc 实现登录就在 screen 中</td>
</tr>
<tr>
<td>screen -r</td>
<td>attach</td>
</tr>
<tr>
<td>ctrl + a c</td>
<td>create 窗口</td>
</tr>
<tr>
<td>ctrl + a k</td>
<td>kill 窗口</td>
</tr>
<tr>
<td>ctrl + a 数字</td>
<td>切换到该窗口</td>
</tr>
<tr>
<td>ctrl + a ctrl + a</td>
<td>切换到刚刚的窗口</td>
</tr>
<tr>
<td>ctrl + a p&#x2F;n</td>
<td>切换到前一个、后一个窗口</td>
</tr>
<tr>
<td>ctrl + a :number 数字</td>
<td><a target="_blank" rel="noopener" href="https://serverfault.com/questions/244294/how-to-re-order-windows-change-the-scroll-shortcut-and-modify-the-status-bar-c">重命名窗口</a>以调整窗口在下方的显示顺序</td>
</tr>
<tr>
<td>上面的自定义按键</td>
<td></td>
</tr>
<tr>
<td>ctrl + a v</td>
<td>分 region</td>
</tr>
<tr>
<td>ctrl + a x</td>
<td>关 region</td>
</tr>
<tr>
<td>ctrl + a tab</td>
<td>切 region</td>
</tr>
</tbody></table>
<h1 id="2-使用"><a href="#2-使用" class="headerlink" title="2 使用"></a>2 使用</h1><p>软件问题见 <a href="/%E8%99%9A%E6%8B%9F%E7%8E%AF%E5%A2%83/2.%20%E5%A4%84%E7%90%86%E5%B9%B3%E5%8F%B0/linux/../linux%E8%BD%AF%E4%BB%B6%E7%BC%96%E8%AF%91%E3%80%81%E5%AE%89%E8%A3%85%E3%80%81%E8%BF%90%E8%A1%8C/">linux软件编译、安装、运行</a></p>
<h2 id="2-1-基础"><a href="#2-1-基础" class="headerlink" title="2.1 基础"></a>2.1 基础</h2><ul>
<li><a target="_blank" rel="noopener" href="https://linuxtools-rst.readthedocs.io/zh_CN/latest/">Linux工具快速教程</a></li>
</ul>
<h3 id="2-1-1-修改-linux-用户名"><a href="#2-1-1-修改-linux-用户名" class="headerlink" title="2.1.1 修改 linux 用户名"></a>2.1.1 修改 linux 用户名</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 退出所有登录（包括 SSH）</span></span><br><span class="line"><span class="comment"># Ctrl+Alt+F2 以 root 登录</span></span><br><span class="line"><span class="comment"># 修改用户名</span></span><br><span class="line">usermod -c “Full name real” -l new_name old_name</span><br><span class="line"><span class="comment"># 修改 home</span></span><br><span class="line">usermod -d /home/newHomeDir -m newUsername</span><br></pre></td></tr></table></figure>

<h3 id="2-1-2-bash"><a href="#2-1-2-bash" class="headerlink" title="2.1.2 bash"></a>2.1.2 bash</h3><ul>
<li><p><a target="_blank" rel="noopener" href="https://skorks.com/2009/09/bash-shortcuts-for-maximum-productivity/">快捷键</a></p>
  <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">Ctrl + r – search the history backwards</span><br><span class="line">Ctrl + g – escape from history searching mode</span><br><span class="line">CTRL + A = the beginning of the line</span><br><span class="line">CTRL + E = the end of the line</span><br><span class="line">ALT  + B = move backward one word </span><br><span class="line">ALT  + F = move forward one word</span><br><span class="line">/* 所有的 ALT 可换成 ESC */</span><br><span class="line">Ctrl + U = Delete left of the cursor</span><br><span class="line">Ctrl + K = Delete right of the cursor</span><br><span class="line">Ctrl + W = Delete word on the left</span><br><span class="line">ALT  + D = Delete word on the right</span><br><span class="line">Ctrl + Y = Paste</span><br></pre></td></tr></table></figure>
</li>
<li><p><a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/ANSI_escape_code">Terminal input sequences</a></p>
</li>
</ul>
<h3 id="2-1-3-zsh"><a href="#2-1-3-zsh" class="headerlink" title="2.1.3 zsh"></a>2.1.3 zsh</h3><ul>
<li>粘贴 kali .zshrc</li>
<li>命令提示 <code>sudo apt install zsh-autosuggestions</code></li>
<li>参考配置 <a href="/%E8%99%9A%E6%8B%9F%E7%8E%AF%E5%A2%83/2.%20%E5%A4%84%E7%90%86%E5%B9%B3%E5%8F%B0/linux/#xa7o">screen</a></li>
</ul>
<h3 id="2-1-4-脚本"><a href="#2-1-4-脚本" class="headerlink" title="2.1.4 脚本"></a>2.1.4 脚本</h3><ul>
<li>shell 脚本调试<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line">-------- bash ---------</span><br><span class="line"><span class="built_in">export</span> SHELLOPTS</span><br><span class="line"><span class="comment"># 还可配合 FUNCNAME 实现调用栈打印</span></span><br><span class="line"><span class="built_in">export</span> PS4=<span class="string">&#x27;[$&#123;BASH_SOURCE[0]&#125;-$LINENO] &#x27;</span></span><br><span class="line"><span class="comment"># 可考虑去掉 eu</span></span><br><span class="line"><span class="built_in">set</span> -eux</span><br><span class="line"><span class="comment"># 确认</span></span><br><span class="line"><span class="built_in">set</span> -o</span><br><span class="line"><span class="comment"># 还原</span></span><br><span class="line"><span class="built_in">set</span> +eux</span><br><span class="line"></span><br><span class="line">-------- zsh ---------</span><br><span class="line"><span class="comment"># https://stackoverflow.com/questions/56137084/zsh-inherit-xtrace-option</span></span><br><span class="line"><span class="comment"># 利用 $ZDOTDIR/.zshenv</span></span><br><span class="line"><span class="comment"># https://stackoverflow.com/questions/9901210/bash-source0-equivalent-in-zsh</span></span><br><span class="line"></span><br><span class="line">-- 注意：下面的所有方法在应对 <span class="built_in">source</span>（即 .） 引入脚本时，不会更新文件名，此时从感兴趣的位置向上找到最近 <span class="built_in">source</span> 的几个脚本，一般就是那里 --</span><br><span class="line"><span class="comment"># 定义 MyShellOpts 开启调试，可考虑去掉 eu</span></span><br><span class="line"><span class="built_in">export</span> MyShellOpts=-eux</span><br><span class="line">-------- ash ---------</span><br><span class="line"></span><br><span class="line"><span class="comment">#!/bin/busybox sh</span></span><br><span class="line"><span class="comment"># 这个脚本保存为 sh 替换 /bin/sh</span></span><br><span class="line"><span class="comment"># 替换方法，确保 /bin/sh 为指向 /bin/dash 的软链接</span></span><br><span class="line"><span class="comment"># sudo chmod --reference=/bin/sh sh</span></span><br><span class="line"><span class="comment"># sudo chown --reference=/bin/sh sh</span></span><br><span class="line"><span class="comment"># sudo cp --remove-destination sh /bin/sh</span></span><br><span class="line"><span class="built_in">export</span> PS4=<span class="string">&#x27;[$0-$LINENO] &#x27;</span></span><br><span class="line">/bin/busybox sh <span class="variable">$MyShellOpts</span> <span class="string">&quot;<span class="variable">$@</span>&quot;</span></span><br><span class="line"></span><br><span class="line">-------- dash或其它类似 shell ---------</span><br><span class="line"></span><br><span class="line"><span class="comment">#!/bin/dash</span></span><br><span class="line"><span class="comment"># 与上面一样，这个脚本保存为 sh 替换 /bin/sh</span></span><br><span class="line"><span class="comment"># $LINENO 存在也可加到 PS4 里，不存在则参考 Workaround for shells without LINENO</span></span><br><span class="line"><span class="comment"># https://stackoverflow.com/questions/17804007/how-to-show-line-number-when-executing-bash-script</span></span><br><span class="line"><span class="comment"># 还原，cd /bin &amp;&amp; sudo ln -f -s dash sh</span></span><br><span class="line"><span class="built_in">export</span> PS4=<span class="string">&#x27;[$0] &#x27;</span></span><br><span class="line"><span class="comment"># 可考虑去掉 eu</span></span><br><span class="line">/bin/dash <span class="variable">$MyShellOpts</span> <span class="string">&quot;<span class="variable">$@</span>&quot;</span></span><br></pre></td></tr></table></figure></li>
<li>不论在那个路径下运行都得到脚本的路径<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 不论在那个路径下运行都得到脚本的路径</span></span><br><span class="line"><span class="comment"># 获取当前脚本路径</span></span><br><span class="line">SCRIPT_DIR=<span class="string">&quot;<span class="subst">$( cd <span class="string">&quot;<span class="subst">$( dirname <span class="string">&quot;<span class="variable">$&#123;BASH_SOURCE[0]&#125;</span>&quot;</span> )</span>&quot;</span> &amp;&gt; /dev/null &amp;&amp; pwd )</span>&quot;</span></span><br></pre></td></tr></table></figure></li>
</ul>
<h3 id="2-1-5-nc"><a href="#2-1-5-nc" class="headerlink" title="2.1.5 nc"></a>2.1.5 nc</h3><ul>
<li>推荐安装 nc openbsd 版本，<code>apt install netcat-openbsd</code></li>
</ul>
<h3 id="2-1-6-curl"><a href="#2-1-6-curl" class="headerlink" title="2.1.6 curl"></a>2.1.6 curl</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># FTP 下载</span></span><br><span class="line">curl ftp://user:pass@192.168.7.29/code/pdt-toolchains/src/tin -o /mnt/internal_storage/tin</span><br><span class="line"><span class="comment"># FTP 上传</span></span><br><span class="line">curl -T /etc/profile ftp://user:pass@192.168.7.29/code/profile</span><br><span class="line"><span class="comment"># 与 docker 通信</span></span><br><span class="line">sudo curl -v -H <span class="string">&#x27;User-Agent:&#x27;</span> -H <span class="string">&#x27;Accept:&#x27;</span> -s --unix-socket /var/run/docker.sock http://localhost/v1.41/containers/json?all=<span class="literal">true</span> | jq .[0]</span><br></pre></td></tr></table></figure>

<h3 id="2-1-7-查找文件"><a href="#2-1-7-查找文件" class="headerlink" title="2.1.7 查找文件"></a>2.1.7 查找文件</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">find /media/d/ -<span class="built_in">type</span> f -size +50M ! \( -name <span class="string">&quot;*deb&quot;</span> -o -name <span class="string">&quot;*vmdk&quot;</span> \)</span><br><span class="line"><span class="comment"># 删除前去掉 delete 进行确认</span></span><br><span class="line">find . -<span class="built_in">type</span> f ! \( -name <span class="string">&#x27;*.cpp&#x27;</span> -o -name <span class="string">&#x27;*.h&#x27;</span> \) -delete</span><br><span class="line"><span class="comment"># 跳过隐藏文件</span></span><br><span class="line">find . -not -path <span class="string">&#x27;*/\.*&#x27;</span> -<span class="built_in">type</span> f ! \( -name <span class="string">&#x27;*.cpp&#x27;</span> -o -name <span class="string">&#x27;*.h&#x27;</span> -o -name <span class="string">&#x27;*.txt&#x27;</span> \)</span><br><span class="line"><span class="comment"># 先创建与源码相同的目录结构再拷贝文件，拷贝文件时忽略某些文件夹下的文件和源码</span></span><br><span class="line">find . \( -<span class="built_in">type</span> d -<span class="built_in">exec</span> <span class="built_in">mkdir</span> -p <span class="string">&#x27;../gatebox_work/&#123;&#125;&#x27;</span> \;   -o -<span class="built_in">type</span> f ! \( -path <span class="string">&#x27;./.git/*&#x27;</span> -o -path <span class="string">&#x27;*/GmSSL/*&#x27;</span> -o -path <span class="string">&#x27;*/.idea/*&#x27;</span> -o -path <span class="string">&#x27;*/.vscode/*&#x27;</span> -o -name <span class="string">&#x27;*.c&#x27;</span> -o -name <span class="string">&#x27;*.h&#x27;</span> -o -name <span class="string">&#x27;*.o&#x27;</span> -o -name <span class="string">&#x27;*.log&#x27;</span> -o -iname makefile \) -<span class="built_in">exec</span> <span class="built_in">cp</span> <span class="string">&#x27;&#123;&#125;&#x27;</span> <span class="string">&#x27;../gatebox_work/&#123;&#125;&#x27;</span> \; \)</span><br></pre></td></tr></table></figure>

<h3 id="2-1-8-磁盘占用统计"><a href="#2-1-8-磁盘占用统计" class="headerlink" title="2.1.8 磁盘占用统计"></a>2.1.8 磁盘占用统计</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo apt install qdirstat</span><br></pre></td></tr></table></figure>

<h3 id="2-1-9-cron"><a href="#2-1-9-cron" class="headerlink" title="2.1.9 cron"></a>2.1.9 cron</h3><ul>
<li>常见 cron <a target="_blank" rel="noopener" href="https://www.warp.dev/terminus/how-to-run-cron-every-hour">写法</a>，<a target="_blank" rel="noopener" href="https://crontab.guru/">计算 cron 下次执行时间</a></li>
<li><code>crontab -e</code> 编辑，cron 会检测 crontab 的更新，自动用最新配置</li>
<li><code>select-editor</code> 改变默认编辑器</li>
</ul>
<h2 id="2-2-网络"><a href="#2-2-网络" class="headerlink" title="2.2 网络"></a>2.2 网络</h2><ul>
<li>wireguard<ul>
<li>看介绍<a target="_blank" rel="noopener" href="https://www.wireguard.com/quickstart/">视频</a>，详细的<a target="_blank" rel="noopener" href="https://www.digitalocean.com/community/tutorials/how-to-set-up-wireguard-on-ubuntu-20-04">配置方法</a>，注意区分 server 和 peer client</li>
<li>对已经有配置文件的，<code>sudo apt install wireguard resolvconf</code>，将配置保存到 <code>/etc/wireguard/wg0.conf</code>，然后 <code>sudo wg-quick up wg0</code></li>
</ul>
</li>
<li>clash_for_windows linux 版，手动安装服务<a target="_blank" rel="noopener" href="https://github.com/Fndroid/clash_for_windows_pkg/issues/3464">方法</a>，网关模式</li>
<li>网速占用统计 apt 安装 nethogs</li>
</ul>
<h1 id="3-备份与还原"><a href="#3-备份与还原" class="headerlink" title="3 备份与还原"></a>3 备份与还原</h1><p>考虑到经常环境经常变动，所以有必要学习linux的备份和还原技术。</p>
<h2 id="3-1-系统备份"><a href="#3-1-系统备份" class="headerlink" title="3.1 系统备份"></a>3.1 系统备份</h2><p>备份脚本  <a target="_blank" rel="noopener" href="https://github.com/pedroetb/rsync-incremental-backup">rsync-incremental-backup</a></p>
<p>注意 rsync 的 exclude 将 源路径 视为 根，因此 exclude 指定的路径都是相对 源路径 来说的，具体可以建立几个测试文件，用 <code>dry-run</code> 的方式验证。恢复的脚本要自己写了，如果进不了系统就用 ubuntu 的安装 U 盘恢复。</p>
<p><strong>下一步</strong>可以配合 cron 实现自动定期备份，配合 ssh 实现远端备份</p>
<h2 id="3-2-启动备份"><a href="#3-2-启动备份" class="headerlink" title="3.2 启动备份"></a>3.2 启动备份</h2><p>多系统的启动管理。每个硬盘一个 MBR，每个系统分区都有个 boot sector，两个位置都会安装 bootloader</p>
<p><img src="/%E8%99%9A%E6%8B%9F%E7%8E%AF%E5%A2%83/2.%20%E5%A4%84%E7%90%86%E5%B9%B3%E5%8F%B0/linux/../linux/mbr_boot_sector.gif" alt="mbr_boot_sector"></p>
<p>多系统启动方式如下，MBR 的 bootloader 可以转交给其它分区的 bootloader，即 chainload</p>
<p><img src="/%E8%99%9A%E6%8B%9F%E7%8E%AF%E5%A2%83/2.%20%E5%A4%84%E7%90%86%E5%B9%B3%E5%8F%B0/linux/../linux/loader_menu.gif" alt="loader_menu"></p>
<p><strong>下一步</strong>可以查看 grub2 的帮助文档，以及用 dd 备份 bootloader 的方法。还原的方法则使用 ubuntu 的 安装U 盘即可。另为 ubuntu 提供了 <a target="_blank" rel="noopener" href="https://help.ubuntu.com/community/Boot-Repair">Boot-Repair</a> 工具。</p>
<p>参考</p>
<ul>
<li><a target="_blank" rel="noopener" href="http://cn.linux.vbird.org/linux_basic/0580backup_1.php">鸟哥备份</a></li>
<li><a target="_blank" rel="noopener" href="http://cn.linux.vbird.org/linux_server/0310telnetssh.php#rsync">鸟哥 rsync</a></li>
<li><a target="_blank" rel="noopener" href="http://www.admin-magazine.com/Articles/Using-rsync-for-Backups">Incremental Backups on Linux</a></li>
<li><a target="_blank" rel="noopener" href="https://wiki.archlinux.org/index.php/Rsync#Full_system_backup">Rsync full system backup</a></li>
</ul>
<script type="module"> import mermaid from 'https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.esm.min.mjs';	mermaid.initialize({startOnLoad: true, flowchart: {curve: 'linear'}}); </script></div><!--!--></article></div><!--!--><div class="card"><div class="card-content"><script src="https://giscus.app/client.js" data-repo="2-3-5-7/2-3-5-7.github.io" data-repo-id="MDEwOlJlcG9zaXRvcnkzNDMwMjg1MTc=" data-category="General" data-category-id="DIC_kwDOFHIzJc4CWmss" data-mapping="pathname" data-strict="0" data-reactions-enabled="0" data-emit-metadata="0" data-input-position="bottom" data-theme="https:/synrst.de/css/light4giscus.css" data-lang="zh-CN" data-loading="lazy" crossorigin="anonymous" async></script></div></div></div><div class="column column-left is-4-tablet is-4-desktop is-4-widescreen  order-1 is-sticky"><div class="card widget" id="toc" data-type="toc"><div class="card-content"><div class="menu"><h3 class="menu-label">目录</h3><ul class="menu-list"><li><a class="level is-mobile" href="#1-配置"><span class="level-left"><span class="level-item">1 配置</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#1-1-SSH"><span class="level-left"><span class="level-item">1.1 SSH</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#1-1-1-解决-20-04-broken-package-问题"><span class="level-left"><span class="level-item">1.1.1 解决 20.04 broken package 问题</span></span></a></li><li><a class="level is-mobile" href="#1-1-2-secureCRT-配置问题"><span class="level-left"><span class="level-item">1.1.2 secureCRT 配置问题</span></span></a></li><li><a class="level is-mobile" href="#1-1-3-隧道-端口转发"><span class="level-left"><span class="level-item">1.1.3 隧道/端口转发</span></span></a></li><li><a class="level is-mobile" href="#1-1-4-DNS-介绍"><span class="level-left"><span class="level-item">1.1.4 DNS 介绍</span></span></a></li></ul></li><li><a class="level is-mobile" href="#1-2-系统"><span class="level-left"><span class="level-item">1.2 系统</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#1-2-1-Kali"><span class="level-left"><span class="level-item">1.2.1 Kali</span></span></a></li></ul></li><li><a class="level is-mobile" href="#1-3-网络"><span class="level-left"><span class="level-item">1.3 网络</span></span></a></li><li><a class="level is-mobile" href="#1-4-内部局域网"><span class="level-left"><span class="level-item">1.4 内部局域网</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#1-4-1-代理"><span class="level-left"><span class="level-item">1.4.1 代理</span></span></a></li><li><a class="level is-mobile" href="#1-4-2-软件源"><span class="level-left"><span class="level-item">1.4.2 软件源</span></span></a></li></ul></li><li><a class="level is-mobile" href="#1-5-sshfs-win"><span class="level-left"><span class="level-item">1.5 sshfs-win</span></span></a></li><li><a class="level is-mobile" href="#1-6-samba、tftp、nfs"><span class="level-left"><span class="level-item">1.6 samba、tftp、nfs</span></span></a></li><li><a class="level is-mobile" href="#1-7-ftp"><span class="level-left"><span class="level-item">1.7 ftp</span></span></a></li><li><a class="level is-mobile" href="#1-8-编译工具"><span class="level-left"><span class="level-item">1.8 编译工具</span></span></a></li><li><a class="level is-mobile" href="#1-9-chrome"><span class="level-left"><span class="level-item">1.9 chrome</span></span></a></li><li><a class="level is-mobile" href="#1-10-vps"><span class="level-left"><span class="level-item">1.10 vps</span></span></a></li><li><a class="level is-mobile" href="#1-11-screen"><span class="level-left"><span class="level-item">1.11 screen</span></span></a></li></ul></li><li><a class="level is-mobile" href="#2-使用"><span class="level-left"><span class="level-item">2 使用</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#2-1-基础"><span class="level-left"><span class="level-item">2.1 基础</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#2-1-1-修改-linux-用户名"><span class="level-left"><span class="level-item">2.1.1 修改 linux 用户名</span></span></a></li><li><a class="level is-mobile" href="#2-1-2-bash"><span class="level-left"><span class="level-item">2.1.2 bash</span></span></a></li><li><a class="level is-mobile" href="#2-1-3-zsh"><span class="level-left"><span class="level-item">2.1.3 zsh</span></span></a></li><li><a class="level is-mobile" href="#2-1-4-脚本"><span class="level-left"><span class="level-item">2.1.4 脚本</span></span></a></li><li><a class="level is-mobile" href="#2-1-5-nc"><span class="level-left"><span class="level-item">2.1.5 nc</span></span></a></li><li><a class="level is-mobile" href="#2-1-6-curl"><span class="level-left"><span class="level-item">2.1.6 curl</span></span></a></li><li><a class="level is-mobile" href="#2-1-7-查找文件"><span class="level-left"><span class="level-item">2.1.7 查找文件</span></span></a></li><li><a class="level is-mobile" href="#2-1-8-磁盘占用统计"><span class="level-left"><span class="level-item">2.1.8 磁盘占用统计</span></span></a></li><li><a class="level is-mobile" href="#2-1-9-cron"><span class="level-left"><span class="level-item">2.1.9 cron</span></span></a></li></ul></li><li><a class="level is-mobile" href="#2-2-网络"><span class="level-left"><span class="level-item">2.2 网络</span></span></a></li></ul></li><li><a class="level is-mobile" href="#3-备份与还原"><span class="level-left"><span class="level-item">3 备份与还原</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#3-1-系统备份"><span class="level-left"><span class="level-item">3.1 系统备份</span></span></a></li><li><a class="level is-mobile" href="#3-2-启动备份"><span class="level-left"><span class="level-item">3.2 启动备份</span></span></a></li></ul></li></ul></div></div><script src="/js/toc.js" defer></script></div><div class="card widget" data-type="categories"><div class="card-content"><div class="menu"><h3 class="menu-label">分类</h3><ul class="menu-list"><li><a class="level is-mobile" href="/categories/%E4%B8%93%E4%B8%9A/"><span class="level-start"><span class="level-item">专业</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/%E7%88%B1%E5%A5%BD/"><span class="level-start"><span class="level-item">爱好</span></span><span class="level-end"><span class="level-item tag">26</span></span></a><ul><li><a class="level is-mobile" href="/categories/%E7%88%B1%E5%A5%BD/Galgame/"><span class="level-start"><span class="level-item">Galgame</span></span><span class="level-end"><span class="level-item tag">13</span></span></a><ul><li><a class="level is-mobile" href="/categories/%E7%88%B1%E5%A5%BD/Galgame/Ever17/"><span class="level-start"><span class="level-item">Ever17</span></span><span class="level-end"><span class="level-item tag">13</span></span></a><ul><li><a class="level is-mobile" href="/categories/%E7%88%B1%E5%A5%BD/Galgame/Ever17/%E4%BA%BA%E7%89%A9/"><span class="level-start"><span class="level-item">人物</span></span><span class="level-end"><span class="level-item tag">8</span></span></a></li><li><a class="level is-mobile" href="/categories/%E7%88%B1%E5%A5%BD/Galgame/Ever17/%E5%9C%B0%E7%82%B9/"><span class="level-start"><span class="level-item">地点</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/%E7%88%B1%E5%A5%BD/Galgame/Ever17/%E5%9C%BA%E6%99%AF/"><span class="level-start"><span class="level-item">场景</span></span><span class="level-end"><span class="level-item tag">3</span></span></a></li></ul></li></ul></li><li><a class="level is-mobile" href="/categories/%E7%88%B1%E5%A5%BD/%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0/"><span class="level-start"><span class="level-item">读书笔记</span></span><span class="level-end"><span class="level-item tag">13</span></span></a></li></ul></li><li><a class="level is-mobile" href="/categories/%E7%89%A9%E7%90%86%E7%8E%AF%E5%A2%83/"><span class="level-start"><span class="level-item">物理环境</span></span><span class="level-end"><span class="level-item tag">13</span></span></a></li><li><a class="level is-mobile" href="/categories/%E8%99%9A%E6%8B%9F%E7%8E%AF%E5%A2%83/"><span class="level-start"><span class="level-item">虚拟环境</span></span><span class="level-end"><span class="level-item tag">19</span></span></a><ul><li><a class="level is-mobile" href="/categories/%E8%99%9A%E6%8B%9F%E7%8E%AF%E5%A2%83/1-%E6%9D%A5%E6%BA%90%E4%B8%8E%E6%94%B6%E9%9B%86/"><span class="level-start"><span class="level-item">1. 来源与收集</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/categories/%E8%99%9A%E6%8B%9F%E7%8E%AF%E5%A2%83/2-%E5%A4%84%E7%90%86%E5%B9%B3%E5%8F%B0/"><span class="level-start"><span class="level-item">2. 处理平台</span></span><span class="level-end"><span class="level-item tag">6</span></span></a></li><li><a class="level is-mobile" href="/categories/%E8%99%9A%E6%8B%9F%E7%8E%AF%E5%A2%83/3-%E5%A4%84%E7%90%86%E5%B7%A5%E5%85%B7/"><span class="level-start"><span class="level-item">3. 处理工具</span></span><span class="level-end"><span class="level-item tag">8</span></span></a></li><li><a class="level is-mobile" href="/categories/%E8%99%9A%E6%8B%9F%E7%8E%AF%E5%A2%83/4-%E5%88%86%E4%BA%AB%E4%B8%8E%E5%A4%87%E4%BB%BD/"><span class="level-start"><span class="level-item">4. 分享与备份</span></span><span class="level-end"><span class="level-item tag">3</span></span></a></li></ul></li></ul></div></div></div></div><!--!--></div></div></section><div><button id="toc-btn" onclick="toc.style.display = &#039;block&#039;;toc.onclick = () =&gt; toc.style.display = &#039;none&#039; " style="display: none;"><i class="fa-solid fa-list-ul"></i></button><button id="search-btn" onclick="document.querySelector(&#039;a.navbar-item.search&#039;).click();" style="display: none;"><i class="fa-solid fa-search fa-sm"></i></button></div><script src="https://cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/moment@2.22.2/min/moment-with-locales.min.js"></script><script src="https://cdn.jsdelivr.net/npm/clipboard@2.0.4/dist/clipboard.min.js" defer></script><script>moment.locale("zh-cn");</script><script>var IcarusThemeSettings = {
            article: {
                highlight: {
                    clipboard: true,
                    fold: 'unfolded'
                }
            }
        };</script><script src="/js/column.js"></script><!--!--><!--!--><!--!--><script src="https://cdn.jsdelivr.net/npm/lightgallery@1.10.0/dist/js/lightgallery.min.js" defer></script><script src="https://cdn.jsdelivr.net/npm/justifiedGallery@3.8.1/dist/js/jquery.justifiedGallery.min.js" defer></script><script>window.addEventListener("load", () => {
            if (typeof $.fn.lightGallery === 'function') {
                $('.article').lightGallery({ selector: '.gallery-item' });
            }
            if (typeof $.fn.justifiedGallery === 'function') {
                if ($('.justified-gallery > p > .gallery-item').length) {
                    $('.justified-gallery > p > .gallery-item').unwrap();
                }
                $('.justified-gallery').justifiedGallery();
            }
        });</script><!--!--><!--!--><!--!--><!--!--><script src="/js/main.js" defer></script><div class="searchbox"><div class="searchbox-container"><div class="searchbox-header"><div class="searchbox-input-container"><input class="searchbox-input" type="text" placeholder="想要查找什么..."></div><a class="searchbox-close" href="javascript:;">×</a></div><div class="searchbox-body"></div></div></div><script src="/js/insight.js" defer></script><script>document.addEventListener('DOMContentLoaded', function () {
            loadInsight({"contentUrl":"/content.json"}, {"hint":"想要查找什么...","untitled":"(无标题)","posts":"文章","pages":"页面","categories":"分类","tags":"标签"});
        });</script></body></html>